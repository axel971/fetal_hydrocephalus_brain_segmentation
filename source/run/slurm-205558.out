Bayesian U-Net 3D spatial concrete dropout
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2022-01-25 14:38:02.047791: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(63, 117, 159, 126)
2022-01-25 14:38:08.526053: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2022-01-25 14:38:08.559687: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-25 14:38:08.560442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-25 14:38:08.560475: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2022-01-25 14:38:08.565474: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2022-01-25 14:38:08.565531: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2022-01-25 14:38:08.568345: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2022-01-25 14:38:08.568965: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2022-01-25 14:38:08.569847: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2022-01-25 14:38:08.570980: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2022-01-25 14:38:08.571442: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2022-01-25 14:38:08.574291: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-25 14:38:08.757826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-25 14:38:08.758564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-25 14:38:08.761282: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-25 14:38:08.761332: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2022-01-25 14:38:09.446426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-25 14:38:09.446481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-25 14:38:09.446496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-25 14:38:09.446503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-25 14:38:09.450310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-25 14:38:09.451318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
WARNING:tensorflow:AutoGraph could not transform <bound method Spatial3DConcreteDropout.call of <model.ConcreteDropout.spatialConcreteDropout.Spatial3DConcreteDropout object at 0x2aac95e04eb0>> and will run it as-is.
Cause: code mixing tabs and spaces for indentation is not allowed
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
---------fold--1---------
training set:  [12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35
 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [ 0  1  2  3  4  5  6  7  8  9 10 11]
testing set size:  12
2022-01-25 14:38:10.245570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-25 14:38:10.246324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-25 14:38:10.248318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-25 14:38:10.248359: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-25 14:38:10.248369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-25 14:38:10.248377: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-25 14:38:10.248384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-25 14:38:10.249751: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-25 14:38:10.250463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
2022-01-25 14:38:11.610643: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-25 14:38:11.611177: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2400085000 Hz
2022-01-25 14:38:18.204789: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2022-01-25 14:38:18.618719: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2022-01-25 14:38:19.084962: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2022-01-25 14:38:19.366417: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 584s - loss: 0.1670 - dice_multi: 0.6565
Epoch 2/100
400/400 - 534s - loss: 0.1178 - dice_multi: 0.7304
Epoch 3/100
400/400 - 534s - loss: 0.1000 - dice_multi: 0.7766
Epoch 4/100
400/400 - 534s - loss: 0.0766 - dice_multi: 0.8167
Epoch 5/100
400/400 - 534s - loss: 0.0672 - dice_multi: 0.8415
Epoch 6/100
400/400 - 534s - loss: 0.0555 - dice_multi: 0.8636
Epoch 7/100
400/400 - 534s - loss: 0.0439 - dice_multi: 0.8873
Epoch 8/100
400/400 - 534s - loss: 0.0396 - dice_multi: 0.8950
Epoch 9/100
400/400 - 533s - loss: 0.0290 - dice_multi: 0.9125
Epoch 10/100
400/400 - 533s - loss: 0.0396 - dice_multi: 0.8983
Epoch 11/100
400/400 - 534s - loss: 0.0400 - dice_multi: 0.8981
Epoch 12/100
400/400 - 534s - loss: 0.0310 - dice_multi: 0.9171
Epoch 13/100
400/400 - 534s - loss: 0.0337 - dice_multi: 0.9114
Epoch 14/100
400/400 - 534s - loss: 0.0288 - dice_multi: 0.9224
Epoch 15/100
400/400 - 534s - loss: 0.0278 - dice_multi: 0.9200
Epoch 16/100
400/400 - 534s - loss: 0.0147 - dice_multi: 0.9381
Epoch 17/100
400/400 - 534s - loss: 0.0212 - dice_multi: 0.9253
Epoch 18/100
400/400 - 534s - loss: 0.0307 - dice_multi: 0.9203
Epoch 19/100
400/400 - 534s - loss: 0.0345 - dice_multi: 0.9101
Epoch 20/100
400/400 - 534s - loss: 0.0259 - dice_multi: 0.9303
Epoch 21/100
400/400 - 534s - loss: 0.0237 - dice_multi: 0.9276
Epoch 22/100
400/400 - 534s - loss: 0.0213 - dice_multi: 0.9323
Epoch 23/100
400/400 - 534s - loss: 0.0149 - dice_multi: 0.9382
Epoch 24/100
400/400 - 534s - loss: 0.0365 - dice_multi: 0.9106
Epoch 25/100
400/400 - 534s - loss: 0.0180 - dice_multi: 0.9366
Epoch 26/100
400/400 - 534s - loss: 0.0226 - dice_multi: 0.9287
Epoch 27/100
400/400 - 534s - loss: 0.0392 - dice_multi: 0.9174
Epoch 28/100
400/400 - 534s - loss: 0.0166 - dice_multi: 0.9420
Epoch 29/100
400/400 - 534s - loss: 0.0248 - dice_multi: 0.9318
Epoch 30/100
400/400 - 534s - loss: 0.0119 - dice_multi: 0.9445
Epoch 31/100
400/400 - 534s - loss: 0.0105 - dice_multi: 0.9432
Epoch 32/100
400/400 - 534s - loss: 0.0107 - dice_multi: 0.9444
Epoch 33/100
400/400 - 534s - loss: 0.0305 - dice_multi: 0.9202
Epoch 34/100
400/400 - 534s - loss: 0.0145 - dice_multi: 0.9408
Epoch 35/100
400/400 - 534s - loss: 0.0145 - dice_multi: 0.9419
Epoch 36/100
400/400 - 534s - loss: 0.0105 - dice_multi: 0.9465
Epoch 37/100
400/400 - 534s - loss: 0.0177 - dice_multi: 0.9386
Epoch 38/100
400/400 - 534s - loss: 0.0170 - dice_multi: 0.9397
Epoch 39/100
400/400 - 534s - loss: 0.0220 - dice_multi: 0.9307
Epoch 40/100
400/400 - 534s - loss: 0.0142 - dice_multi: 0.9435
Epoch 41/100
400/400 - 534s - loss: 0.0091 - dice_multi: 0.9467
Epoch 42/100
400/400 - 534s - loss: 0.0068 - dice_multi: 0.9501
Epoch 43/100
400/400 - 534s - loss: 0.0122 - dice_multi: 0.9428
Epoch 44/100
400/400 - 534s - loss: 0.0118 - dice_multi: 0.9427
Epoch 45/100
400/400 - 534s - loss: 0.0076 - dice_multi: 0.9474
Epoch 46/100
400/400 - 534s - loss: 0.0241 - dice_multi: 0.9274
Epoch 47/100
400/400 - 534s - loss: 0.0181 - dice_multi: 0.9395
Epoch 48/100
400/400 - 534s - loss: 0.0087 - dice_multi: 0.9500
Epoch 49/100
400/400 - 534s - loss: 0.0208 - dice_multi: 0.9313
Epoch 50/100
400/400 - 534s - loss: 0.0142 - dice_multi: 0.9450
Epoch 51/100
400/400 - 534s - loss: 0.0080 - dice_multi: 0.9499
Epoch 52/100
400/400 - 534s - loss: 0.0094 - dice_multi: 0.9463
Epoch 53/100
400/400 - 534s - loss: 0.0083 - dice_multi: 0.9489
Epoch 54/100
400/400 - 534s - loss: 0.0151 - dice_multi: 0.9345
Epoch 55/100
400/400 - 534s - loss: 0.0136 - dice_multi: 0.9419
Epoch 56/100
400/400 - 534s - loss: 0.0077 - dice_multi: 0.9489
Epoch 57/100
400/400 - 534s - loss: 0.0103 - dice_multi: 0.9436
Epoch 58/100
400/400 - 534s - loss: 0.0076 - dice_multi: 0.9505
Epoch 59/100
400/400 - 533s - loss: 0.0141 - dice_multi: 0.9400
Epoch 60/100
400/400 - 533s - loss: 0.0069 - dice_multi: 0.9497
Epoch 61/100
400/400 - 534s - loss: 0.0044 - dice_multi: 0.9529
Epoch 62/100
400/400 - 534s - loss: 0.0110 - dice_multi: 0.9430
Epoch 63/100
400/400 - 534s - loss: 0.0139 - dice_multi: 0.9429
Epoch 64/100
400/400 - 534s - loss: 0.0060 - dice_multi: 0.9518
Epoch 65/100
400/400 - 534s - loss: 0.0073 - dice_multi: 0.9481
Epoch 66/100
400/400 - 534s - loss: 0.0049 - dice_multi: 0.9512
Epoch 67/100
400/400 - 533s - loss: 0.0135 - dice_multi: 0.9404
Epoch 68/100
400/400 - 533s - loss: 0.0101 - dice_multi: 0.9482
Epoch 69/100
400/400 - 534s - loss: 0.0040 - dice_multi: 0.9532
Epoch 70/100
400/400 - 534s - loss: 0.0040 - dice_multi: 0.9531
Epoch 71/100
400/400 - 534s - loss: 0.0031 - dice_multi: 0.9519
Epoch 72/100
400/400 - 534s - loss: 0.0157 - dice_multi: 0.9350
Epoch 73/100
400/400 - 534s - loss: 0.0077 - dice_multi: 0.9509
Epoch 74/100
400/400 - 534s - loss: 0.0049 - dice_multi: 0.9518
Epoch 75/100
400/400 - 533s - loss: 0.0109 - dice_multi: 0.9393
Epoch 76/100
400/400 - 533s - loss: 0.0150 - dice_multi: 0.9424
Epoch 77/100
400/400 - 533s - loss: 0.0065 - dice_multi: 0.9506
Epoch 78/100
400/400 - 533s - loss: 0.0063 - dice_multi: 0.9503
Epoch 79/100
400/400 - 534s - loss: 0.0106 - dice_multi: 0.9459
Epoch 80/100
400/400 - 534s - loss: 0.0061 - dice_multi: 0.9515
Epoch 81/100
400/400 - 534s - loss: 0.0056 - dice_multi: 0.9528
Epoch 82/100
400/400 - 534s - loss: 0.0025 - dice_multi: 0.9541
Epoch 83/100
400/400 - 534s - loss: 0.0141 - dice_multi: 0.9396
Epoch 84/100
400/400 - 534s - loss: 0.0072 - dice_multi: 0.9508
Epoch 85/100
400/400 - 534s - loss: 0.0043 - dice_multi: 0.9531
Epoch 86/100
400/400 - 534s - loss: 0.0043 - dice_multi: 0.9531
Epoch 87/100
400/400 - 534s - loss: 0.0042 - dice_multi: 0.9525
Epoch 88/100
400/400 - 534s - loss: 0.0195 - dice_multi: 0.9303
Epoch 89/100
400/400 - 534s - loss: 0.0155 - dice_multi: 0.9385
Epoch 90/100
400/400 - 534s - loss: 0.0064 - dice_multi: 0.9515
Epoch 91/100
400/400 - 534s - loss: 0.0067 - dice_multi: 0.9507
Epoch 92/100
400/400 - 534s - loss: 0.0041 - dice_multi: 0.9535
Epoch 93/100
400/400 - 534s - loss: 0.0024 - dice_multi: 0.9535
Epoch 94/100
400/400 - 534s - loss: 0.0032 - dice_multi: 0.9512
Epoch 95/100
400/400 - 534s - loss: 0.0042 - dice_multi: 0.9498
Epoch 96/100
400/400 - 534s - loss: 0.0051 - dice_multi: 0.9514
Epoch 97/100
400/400 - 533s - loss: 0.0051 - dice_multi: 0.9511
Epoch 98/100
400/400 - 534s - loss: 0.0031 - dice_multi: 0.9528
Epoch 99/100
400/400 - 534s - loss: 0.0078 - dice_multi: 0.9463
Epoch 100/100
400/400 - 534s - loss: 0.0060 - dice_multi: 0.9526
2022-01-26 05:57:47.515424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-26 05:57:47.516505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-26 05:57:47.518641: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-26 05:57:47.518715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-26 05:57:47.518728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-26 05:57:47.518737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-26 05:57:47.518745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-26 05:57:47.520221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-26 05:57:47.521020: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 53421.18443107605
executation time:145.64667429526648
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 24 25 26 27 28 29 30 31 32 33 34 35
 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [12 13 14 15 16 17 18 19 20 21 22 23]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 540s - loss: 0.1491 - dice_multi: 0.6987
Epoch 2/100
400/400 - 533s - loss: 0.1093 - dice_multi: 0.7506
Epoch 3/100
400/400 - 533s - loss: 0.0828 - dice_multi: 0.8066
Epoch 4/100
400/400 - 533s - loss: 0.0779 - dice_multi: 0.8329
Epoch 5/100
400/400 - 533s - loss: 0.0546 - dice_multi: 0.8803
Epoch 6/100
400/400 - 533s - loss: 0.0470 - dice_multi: 0.8856
Epoch 7/100
400/400 - 533s - loss: 0.0394 - dice_multi: 0.8995
Epoch 8/100
400/400 - 533s - loss: 0.0323 - dice_multi: 0.9101
Epoch 9/100
400/400 - 533s - loss: 0.0380 - dice_multi: 0.9030
Epoch 10/100
400/400 - 533s - loss: 0.0325 - dice_multi: 0.9145
Epoch 11/100
400/400 - 533s - loss: 0.0378 - dice_multi: 0.9051
Epoch 12/100
400/400 - 533s - loss: 0.0321 - dice_multi: 0.9160
Epoch 13/100
400/400 - 533s - loss: 0.0381 - dice_multi: 0.9078
Epoch 14/100
400/400 - 533s - loss: 0.0193 - dice_multi: 0.9337
Epoch 15/100
400/400 - 533s - loss: 0.0227 - dice_multi: 0.9283
Epoch 16/100
400/400 - 533s - loss: 0.0283 - dice_multi: 0.9201
Epoch 17/100
400/400 - 533s - loss: 0.0187 - dice_multi: 0.9352
Epoch 18/100
400/400 - 533s - loss: 0.0361 - dice_multi: 0.9135
Epoch 19/100
400/400 - 533s - loss: 0.0212 - dice_multi: 0.9324
Epoch 20/100
400/400 - 533s - loss: 0.0179 - dice_multi: 0.9354
Epoch 21/100
400/400 - 533s - loss: 0.0194 - dice_multi: 0.9311
Epoch 22/100
400/400 - 533s - loss: 0.0570 - dice_multi: 0.8795
Epoch 23/100
400/400 - 533s - loss: 0.0263 - dice_multi: 0.9265
Epoch 24/100
400/400 - 533s - loss: 0.0158 - dice_multi: 0.9396
Epoch 25/100
400/400 - 533s - loss: 0.0316 - dice_multi: 0.9188
Epoch 26/100
400/400 - 533s - loss: 0.0205 - dice_multi: 0.9317
Epoch 27/100
400/400 - 533s - loss: 0.0159 - dice_multi: 0.9404
Epoch 28/100
400/400 - 533s - loss: 0.0204 - dice_multi: 0.9358
Epoch 29/100
400/400 - 533s - loss: 0.0137 - dice_multi: 0.9415
Epoch 30/100
400/400 - 533s - loss: 0.0108 - dice_multi: 0.9423
Epoch 31/100
400/400 - 533s - loss: 0.0220 - dice_multi: 0.9310
Epoch 32/100
400/400 - 533s - loss: 0.0167 - dice_multi: 0.9389
Epoch 33/100
400/400 - 533s - loss: 0.0146 - dice_multi: 0.9404
Epoch 34/100
400/400 - 533s - loss: 0.0147 - dice_multi: 0.9386
Epoch 35/100
400/400 - 533s - loss: 0.0153 - dice_multi: 0.9416
Epoch 36/100
400/400 - 533s - loss: 0.0351 - dice_multi: 0.9156
Epoch 37/100
400/400 - 533s - loss: 0.0132 - dice_multi: 0.9443
Epoch 38/100
400/400 - 533s - loss: 0.0215 - dice_multi: 0.9336
Epoch 39/100
400/400 - 533s - loss: 0.0131 - dice_multi: 0.9416
Epoch 40/100
400/400 - 533s - loss: 0.0146 - dice_multi: 0.9420
Epoch 41/100
400/400 - 533s - loss: 0.0089 - dice_multi: 0.9484
Epoch 42/100
400/400 - 533s - loss: 0.0198 - dice_multi: 0.9280
Epoch 43/100
400/400 - 533s - loss: 0.0154 - dice_multi: 0.9424
Epoch 44/100
400/400 - 533s - loss: 0.0125 - dice_multi: 0.9415
Epoch 45/100
400/400 - 533s - loss: 0.0325 - dice_multi: 0.9173
Epoch 46/100
400/400 - 533s - loss: 0.0199 - dice_multi: 0.9342
Epoch 47/100
400/400 - 533s - loss: 0.0113 - dice_multi: 0.9455
Epoch 48/100
400/400 - 533s - loss: 0.0100 - dice_multi: 0.9448
Epoch 49/100
400/400 - 533s - loss: 0.0094 - dice_multi: 0.9447
Epoch 50/100
400/400 - 533s - loss: 0.0077 - dice_multi: 0.9478
Epoch 51/100
400/400 - 533s - loss: 0.0220 - dice_multi: 0.9339
Epoch 52/100
400/400 - 533s - loss: 0.0104 - dice_multi: 0.9458
Epoch 53/100
400/400 - 533s - loss: 0.0144 - dice_multi: 0.9412
Epoch 54/100
400/400 - 533s - loss: 0.0237 - dice_multi: 0.9327
Epoch 55/100
400/400 - 533s - loss: 0.0099 - dice_multi: 0.9480
Epoch 56/100
400/400 - 533s - loss: 0.0102 - dice_multi: 0.9456
Epoch 57/100
400/400 - 533s - loss: 0.0091 - dice_multi: 0.9452
Epoch 58/100
400/400 - 533s - loss: 0.0146 - dice_multi: 0.9411
Epoch 59/100
400/400 - 533s - loss: 0.0091 - dice_multi: 0.9493
Epoch 60/100
400/400 - 533s - loss: 0.0055 - dice_multi: 0.9509
Epoch 61/100
400/400 - 533s - loss: 0.0207 - dice_multi: 0.9316
Epoch 62/100
400/400 - 533s - loss: 0.0103 - dice_multi: 0.9469
Epoch 63/100
400/400 - 533s - loss: 0.0146 - dice_multi: 0.9393
Epoch 64/100
400/400 - 533s - loss: 0.0085 - dice_multi: 0.9490
Epoch 65/100
400/400 - 533s - loss: 0.0064 - dice_multi: 0.9483
Epoch 66/100
400/400 - 533s - loss: 0.0156 - dice_multi: 0.9360
Epoch 67/100
400/400 - 533s - loss: 0.0183 - dice_multi: 0.9387
Epoch 68/100
400/400 - 533s - loss: 0.0082 - dice_multi: 0.9504
Epoch 69/100
400/400 - 533s - loss: 0.0062 - dice_multi: 0.9495
Epoch 70/100
400/400 - 533s - loss: 0.0200 - dice_multi: 0.9316
Epoch 71/100
400/400 - 533s - loss: 0.0130 - dice_multi: 0.9468
Epoch 72/100
400/400 - 533s - loss: 0.0081 - dice_multi: 0.9484
Epoch 73/100
400/400 - 533s - loss: 0.0071 - dice_multi: 0.9494
Epoch 74/100
400/400 - 533s - loss: 0.0069 - dice_multi: 0.9492
Epoch 75/100
400/400 - 533s - loss: 0.0089 - dice_multi: 0.9452
Epoch 76/100
400/400 - 533s - loss: 0.0136 - dice_multi: 0.9436
Epoch 77/100
400/400 - 533s - loss: 0.0057 - dice_multi: 0.9512
Epoch 78/100
400/400 - 533s - loss: 0.0101 - dice_multi: 0.9453
Epoch 79/100
400/400 - 533s - loss: 0.0050 - dice_multi: 0.9504
Epoch 80/100
400/400 - 533s - loss: 0.0195 - dice_multi: 0.9361
Epoch 81/100
400/400 - 533s - loss: 0.0058 - dice_multi: 0.9514
Epoch 82/100
400/400 - 533s - loss: 0.0048 - dice_multi: 0.9500
Epoch 83/100
400/400 - 533s - loss: 0.0065 - dice_multi: 0.9494
Epoch 84/100
400/400 - 533s - loss: 0.0050 - dice_multi: 0.9505
Epoch 85/100
400/400 - 533s - loss: 0.0127 - dice_multi: 0.9438
Epoch 86/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9519
Epoch 87/100
400/400 - 533s - loss: 0.0065 - dice_multi: 0.9482
Epoch 88/100
400/400 - 533s - loss: 0.0063 - dice_multi: 0.9494
Epoch 89/100
400/400 - 533s - loss: 0.0198 - dice_multi: 0.9337
Epoch 90/100
400/400 - 533s - loss: 0.0096 - dice_multi: 0.9472
Epoch 91/100
400/400 - 533s - loss: 0.0093 - dice_multi: 0.9495
Epoch 92/100
400/400 - 533s - loss: 0.0067 - dice_multi: 0.9492
Epoch 93/100
400/400 - 533s - loss: 0.0036 - dice_multi: 0.9535
Epoch 94/100
400/400 - 533s - loss: 0.0085 - dice_multi: 0.9472
Epoch 95/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9505
Epoch 96/100
400/400 - 533s - loss: 0.0060 - dice_multi: 0.9501
Epoch 97/100
400/400 - 533s - loss: 0.0042 - dice_multi: 0.9522
Epoch 98/100
400/400 - 533s - loss: 0.0073 - dice_multi: 0.9476
Epoch 99/100
400/400 - 533s - loss: 0.0050 - dice_multi: 0.9507
Epoch 100/100
400/400 - 533s - loss: 0.0033 - dice_multi: 0.9513
2022-01-26 21:15:46.175767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-26 21:15:46.192968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-26 21:15:46.195072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-26 21:15:46.195156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-26 21:15:46.195169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-26 21:15:46.195178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-26 21:15:46.195207: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-26 21:15:46.196766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-26 21:15:46.197529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 53329.41819834709
executation time:145.1280693014463
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [24 25 26 27 28 29 30 31 32 33 34 35]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 541s - loss: 0.1463 - dice_multi: 0.6980
Epoch 2/100
400/400 - 533s - loss: 0.0883 - dice_multi: 0.7870
Epoch 3/100
400/400 - 533s - loss: 0.0852 - dice_multi: 0.8074
Epoch 4/100
400/400 - 533s - loss: 0.0646 - dice_multi: 0.8438
Epoch 5/100
400/400 - 533s - loss: 0.0581 - dice_multi: 0.8679
Epoch 6/100
400/400 - 533s - loss: 0.0427 - dice_multi: 0.8977
Epoch 7/100
400/400 - 533s - loss: 0.0679 - dice_multi: 0.8466
Epoch 8/100
400/400 - 533s - loss: 0.0304 - dice_multi: 0.9134
Epoch 9/100
400/400 - 533s - loss: 0.0424 - dice_multi: 0.8936
Epoch 10/100
400/400 - 533s - loss: 0.0487 - dice_multi: 0.8829
Epoch 11/100
400/400 - 533s - loss: 0.0341 - dice_multi: 0.9071
Epoch 12/100
400/400 - 533s - loss: 0.0226 - dice_multi: 0.9278
Epoch 13/100
400/400 - 533s - loss: 0.0214 - dice_multi: 0.9267
Epoch 14/100
400/400 - 533s - loss: 0.0450 - dice_multi: 0.8938
Epoch 15/100
400/400 - 533s - loss: 0.0265 - dice_multi: 0.9214
Epoch 16/100
400/400 - 533s - loss: 0.0214 - dice_multi: 0.9303
Epoch 17/100
400/400 - 533s - loss: 0.0344 - dice_multi: 0.9096
Epoch 18/100
400/400 - 533s - loss: 0.0154 - dice_multi: 0.9362
Epoch 19/100
400/400 - 533s - loss: 0.0208 - dice_multi: 0.9287
Epoch 20/100
400/400 - 533s - loss: 0.0418 - dice_multi: 0.9017
Epoch 21/100
400/400 - 533s - loss: 0.0207 - dice_multi: 0.9340
Epoch 22/100
400/400 - 533s - loss: 0.0127 - dice_multi: 0.9410
Epoch 23/100
400/400 - 533s - loss: 0.0177 - dice_multi: 0.9354
Epoch 24/100
400/400 - 533s - loss: 0.0241 - dice_multi: 0.9298
Epoch 25/100
400/400 - 533s - loss: 0.0263 - dice_multi: 0.9273
Epoch 26/100
400/400 - 533s - loss: 0.0162 - dice_multi: 0.9400
Epoch 27/100
400/400 - 533s - loss: 0.0108 - dice_multi: 0.9466
Epoch 28/100
400/400 - 533s - loss: 0.0099 - dice_multi: 0.9432
Epoch 29/100
400/400 - 533s - loss: 0.0151 - dice_multi: 0.9382
Epoch 30/100
400/400 - 533s - loss: 0.0240 - dice_multi: 0.9260
Epoch 31/100
400/400 - 533s - loss: 0.0207 - dice_multi: 0.9370
Epoch 32/100
400/400 - 533s - loss: 0.0110 - dice_multi: 0.9467
Epoch 33/100
400/400 - 533s - loss: 0.0296 - dice_multi: 0.9218
Epoch 34/100
400/400 - 533s - loss: 0.0157 - dice_multi: 0.9416
Epoch 35/100
400/400 - 533s - loss: 0.0107 - dice_multi: 0.9468
Epoch 36/100
400/400 - 533s - loss: 0.0144 - dice_multi: 0.9406
Epoch 37/100
400/400 - 533s - loss: 0.0176 - dice_multi: 0.9360
Epoch 38/100
400/400 - 533s - loss: 0.0082 - dice_multi: 0.9489
Epoch 39/100
400/400 - 533s - loss: 0.0116 - dice_multi: 0.9430
Epoch 40/100
400/400 - 533s - loss: 0.0103 - dice_multi: 0.9471
Epoch 41/100
400/400 - 533s - loss: 0.0296 - dice_multi: 0.9225
Epoch 42/100
400/400 - 533s - loss: 0.0108 - dice_multi: 0.9474
Epoch 43/100
400/400 - 533s - loss: 0.0078 - dice_multi: 0.9484
Epoch 44/100
400/400 - 533s - loss: 0.0226 - dice_multi: 0.9318
Epoch 45/100
400/400 - 533s - loss: 0.0135 - dice_multi: 0.9441
Epoch 46/100
400/400 - 532s - loss: 0.0070 - dice_multi: 0.9503
Epoch 47/100
400/400 - 533s - loss: 0.0219 - dice_multi: 0.9313
Epoch 48/100
400/400 - 533s - loss: 0.0099 - dice_multi: 0.9486
Epoch 49/100
400/400 - 533s - loss: 0.0063 - dice_multi: 0.9495
Epoch 50/100
400/400 - 533s - loss: 0.0089 - dice_multi: 0.9479
Epoch 51/100
400/400 - 533s - loss: 0.0101 - dice_multi: 0.9470
Epoch 52/100
400/400 - 533s - loss: 0.0092 - dice_multi: 0.9448
Epoch 53/100
400/400 - 533s - loss: 0.0119 - dice_multi: 0.9440
Epoch 54/100
400/400 - 533s - loss: 0.0083 - dice_multi: 0.9504
Epoch 55/100
400/400 - 533s - loss: 0.0309 - dice_multi: 0.9215
Epoch 56/100
400/400 - 533s - loss: 0.0096 - dice_multi: 0.9504
Epoch 57/100
400/400 - 533s - loss: 0.0145 - dice_multi: 0.9413
Epoch 58/100
400/400 - 533s - loss: 0.0069 - dice_multi: 0.9501
Epoch 59/100
400/400 - 533s - loss: 0.0089 - dice_multi: 0.9493
Epoch 60/100
400/400 - 533s - loss: 0.0087 - dice_multi: 0.9486
Epoch 61/100
400/400 - 532s - loss: 0.0084 - dice_multi: 0.9478
Epoch 62/100
400/400 - 533s - loss: 0.0081 - dice_multi: 0.9489
Epoch 63/100
400/400 - 533s - loss: 0.0065 - dice_multi: 0.9507
Epoch 64/100
400/400 - 533s - loss: 0.0131 - dice_multi: 0.9373
Epoch 65/100
400/400 - 533s - loss: 0.0188 - dice_multi: 0.9385
Epoch 66/100
400/400 - 533s - loss: 0.0110 - dice_multi: 0.9482
Epoch 67/100
400/400 - 533s - loss: 0.0068 - dice_multi: 0.9519
Epoch 68/100
400/400 - 533s - loss: 0.0068 - dice_multi: 0.9498
Epoch 69/100
400/400 - 533s - loss: 0.0131 - dice_multi: 0.9447
Epoch 70/100
400/400 - 533s - loss: 0.0149 - dice_multi: 0.9395
Epoch 71/100
400/400 - 533s - loss: 0.0065 - dice_multi: 0.9516
Epoch 72/100
400/400 - 533s - loss: 0.0113 - dice_multi: 0.9435
Epoch 73/100
400/400 - 533s - loss: 0.0173 - dice_multi: 0.9429
Epoch 74/100
400/400 - 533s - loss: 0.0078 - dice_multi: 0.9499
Epoch 75/100
400/400 - 533s - loss: 0.0047 - dice_multi: 0.9548
Epoch 76/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9516
Epoch 77/100
400/400 - 533s - loss: 0.0173 - dice_multi: 0.9378
Epoch 78/100
400/400 - 533s - loss: 0.0102 - dice_multi: 0.9498
Epoch 79/100
400/400 - 533s - loss: 0.0081 - dice_multi: 0.9500
Epoch 80/100
400/400 - 533s - loss: 0.0059 - dice_multi: 0.9530
Epoch 81/100
400/400 - 533s - loss: 0.0042 - dice_multi: 0.9525
Epoch 82/100
400/400 - 533s - loss: 0.0046 - dice_multi: 0.9533
Epoch 83/100
400/400 - 533s - loss: 0.0168 - dice_multi: 0.9377
Epoch 84/100
400/400 - 533s - loss: 0.0058 - dice_multi: 0.9514
Epoch 85/100
400/400 - 533s - loss: 0.0157 - dice_multi: 0.9423
Epoch 86/100
400/400 - 533s - loss: 0.0083 - dice_multi: 0.9521
Epoch 87/100
400/400 - 533s - loss: 0.0082 - dice_multi: 0.9481
Epoch 88/100
400/400 - 533s - loss: 0.0069 - dice_multi: 0.9527
Epoch 89/100
400/400 - 533s - loss: 0.0037 - dice_multi: 0.9540
Epoch 90/100
400/400 - 533s - loss: 0.0121 - dice_multi: 0.9433
Epoch 91/100
400/400 - 533s - loss: 0.0097 - dice_multi: 0.9508
Epoch 92/100
400/400 - 533s - loss: 0.0098 - dice_multi: 0.9500
Epoch 93/100
400/400 - 533s - loss: 0.0046 - dice_multi: 0.9539
Epoch 94/100
400/400 - 533s - loss: 0.0038 - dice_multi: 0.9532
Epoch 95/100
400/400 - 533s - loss: 0.0051 - dice_multi: 0.9523
Epoch 96/100
400/400 - 533s - loss: 0.0037 - dice_multi: 0.9544
Epoch 97/100
400/400 - 533s - loss: 0.0196 - dice_multi: 0.9344
Epoch 98/100
400/400 - 533s - loss: 0.0110 - dice_multi: 0.9506
Epoch 99/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9530
Epoch 100/100
400/400 - 533s - loss: 0.0072 - dice_multi: 0.9516
2022-01-27 12:33:18.757113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-27 12:33:18.758796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-27 12:33:18.760981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-27 12:33:18.761048: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-27 12:33:18.761061: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-27 12:33:18.761071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-27 12:33:18.761078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-27 12:33:18.762606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-27 12:33:18.763409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 53302.278054475784
executation time:145.15091947714487
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [36 37 38 39 40 41 42 43 44 45 46 47]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 541s - loss: 0.1378 - dice_multi: 0.6988
Epoch 2/100
400/400 - 534s - loss: 0.0699 - dice_multi: 0.8117
Epoch 3/100
400/400 - 534s - loss: 0.0527 - dice_multi: 0.8630
Epoch 4/100
400/400 - 533s - loss: 0.0519 - dice_multi: 0.8699
Epoch 5/100
400/400 - 533s - loss: 0.0352 - dice_multi: 0.9034
Epoch 6/100
400/400 - 533s - loss: 0.0469 - dice_multi: 0.8702
Epoch 7/100
400/400 - 533s - loss: 0.0329 - dice_multi: 0.9025
Epoch 8/100
400/400 - 533s - loss: 0.0290 - dice_multi: 0.9108
Epoch 9/100
400/400 - 533s - loss: 0.0193 - dice_multi: 0.9247
Epoch 10/100
400/400 - 533s - loss: 0.0281 - dice_multi: 0.9068
Epoch 11/100
400/400 - 533s - loss: 0.0168 - dice_multi: 0.9317
Epoch 12/100
400/400 - 533s - loss: 0.0189 - dice_multi: 0.9265
Epoch 13/100
400/400 - 533s - loss: 0.0145 - dice_multi: 0.9320
Epoch 14/100
400/400 - 533s - loss: 0.0182 - dice_multi: 0.9266
Epoch 15/100
400/400 - 533s - loss: 0.0123 - dice_multi: 0.9374
Epoch 16/100
400/400 - 533s - loss: 0.0149 - dice_multi: 0.9336
Epoch 17/100
400/400 - 533s - loss: 0.0103 - dice_multi: 0.9380
Epoch 18/100
400/400 - 533s - loss: 0.0145 - dice_multi: 0.9330
Epoch 19/100
400/400 - 533s - loss: 0.0098 - dice_multi: 0.9411
Epoch 20/100
400/400 - 533s - loss: 0.0143 - dice_multi: 0.9352
Epoch 21/100
400/400 - 533s - loss: 0.0113 - dice_multi: 0.9388
Epoch 22/100
400/400 - 533s - loss: 0.0090 - dice_multi: 0.9428
Epoch 23/100
400/400 - 533s - loss: 0.0073 - dice_multi: 0.9428
Epoch 24/100
400/400 - 533s - loss: 0.0099 - dice_multi: 0.9411
Epoch 25/100
400/400 - 533s - loss: 0.0117 - dice_multi: 0.9372
Epoch 26/100
400/400 - 533s - loss: 0.0118 - dice_multi: 0.9368
Epoch 27/100
400/400 - 533s - loss: 0.0069 - dice_multi: 0.9448
Epoch 28/100
400/400 - 533s - loss: 0.0089 - dice_multi: 0.9428
Epoch 29/100
400/400 - 533s - loss: 0.0111 - dice_multi: 0.9391
Epoch 30/100
400/400 - 533s - loss: 0.0079 - dice_multi: 0.9449
Epoch 31/100
400/400 - 533s - loss: 0.0118 - dice_multi: 0.9377
Epoch 32/100
400/400 - 533s - loss: 0.0063 - dice_multi: 0.9465
Epoch 33/100
400/400 - 533s - loss: 0.0053 - dice_multi: 0.9458
Epoch 34/100
400/400 - 533s - loss: 0.0109 - dice_multi: 0.9401
Epoch 35/100
400/400 - 533s - loss: 0.0076 - dice_multi: 0.9428
Epoch 36/100
400/400 - 533s - loss: 0.0083 - dice_multi: 0.9438
Epoch 37/100
400/400 - 533s - loss: 0.0082 - dice_multi: 0.9443
Epoch 38/100
400/400 - 533s - loss: 0.0068 - dice_multi: 0.9452
Epoch 39/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9446
Epoch 40/100
400/400 - 534s - loss: 0.0038 - dice_multi: 0.9483
Epoch 41/100
400/400 - 534s - loss: 0.0076 - dice_multi: 0.9425
Epoch 42/100
400/400 - 533s - loss: 0.0068 - dice_multi: 0.9457
Epoch 43/100
400/400 - 533s - loss: 0.0043 - dice_multi: 0.9475
Epoch 44/100
400/400 - 534s - loss: 0.0083 - dice_multi: 0.9433
Epoch 45/100
400/400 - 533s - loss: 0.0115 - dice_multi: 0.9388
Epoch 46/100
400/400 - 534s - loss: 0.0051 - dice_multi: 0.9497
Epoch 47/100
400/400 - 533s - loss: 0.0043 - dice_multi: 0.9477
Epoch 48/100
400/400 - 533s - loss: 0.0071 - dice_multi: 0.9452
Epoch 49/100
400/400 - 533s - loss: 0.0029 - dice_multi: 0.9500
Epoch 50/100
400/400 - 534s - loss: 0.0035 - dice_multi: 0.9498
Epoch 51/100
400/400 - 533s - loss: 0.0087 - dice_multi: 0.9437
Epoch 52/100
400/400 - 533s - loss: 0.0021 - dice_multi: 0.9510
Epoch 53/100
400/400 - 533s - loss: 0.0075 - dice_multi: 0.9431
Epoch 54/100
400/400 - 534s - loss: 0.0035 - dice_multi: 0.9500
Epoch 55/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9463
Epoch 56/100
400/400 - 533s - loss: 0.0026 - dice_multi: 0.9504
Epoch 57/100
400/400 - 533s - loss: 0.0029 - dice_multi: 0.9505
Epoch 58/100
400/400 - 534s - loss: 0.0045 - dice_multi: 0.9463
Epoch 59/100
400/400 - 533s - loss: 0.0023 - dice_multi: 0.9503
Epoch 60/100
400/400 - 534s - loss: 0.0056 - dice_multi: 0.9440
Epoch 61/100
400/400 - 534s - loss: 0.0032 - dice_multi: 0.9513
Epoch 62/100
400/400 - 534s - loss: 6.8815e-04 - dice_multi: 0.9527
Epoch 63/100
400/400 - 534s - loss: 0.0041 - dice_multi: 0.9458
Epoch 64/100
400/400 - 533s - loss: 0.0106 - dice_multi: 0.9431
Epoch 65/100
400/400 - 533s - loss: 0.0036 - dice_multi: 0.9492
Epoch 66/100
400/400 - 533s - loss: 0.0024 - dice_multi: 0.9503
Epoch 67/100
400/400 - 533s - loss: 0.0043 - dice_multi: 0.9476
Epoch 68/100
400/400 - 533s - loss: 0.0013 - dice_multi: 0.9526
Epoch 69/100
400/400 - 533s - loss: 0.0040 - dice_multi: 0.9466
Epoch 70/100
400/400 - 533s - loss: 0.0045 - dice_multi: 0.9483
Epoch 71/100
400/400 - 533s - loss: 0.0038 - dice_multi: 0.9494
Epoch 72/100
400/400 - 533s - loss: 0.0010 - dice_multi: 0.9531
Epoch 73/100
400/400 - 533s - loss: 2.4487e-04 - dice_multi: 0.9524
Epoch 74/100
400/400 - 533s - loss: 0.0056 - dice_multi: 0.9464
Epoch 75/100
400/400 - 533s - loss: 0.0021 - dice_multi: 0.9514
Epoch 76/100
400/400 - 533s - loss: 0.0061 - dice_multi: 0.9441
Epoch 77/100
400/400 - 533s - loss: 0.0080 - dice_multi: 0.9464
Epoch 78/100
400/400 - 533s - loss: 0.0019 - dice_multi: 0.9518
Epoch 79/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9474
Epoch 80/100
400/400 - 533s - loss: 0.0028 - dice_multi: 0.9510
Epoch 81/100
400/400 - 533s - loss: 2.9541e-04 - dice_multi: 0.9534
Epoch 82/100
400/400 - 533s - loss: 0.0023 - dice_multi: 0.9504
Epoch 83/100
400/400 - 533s - loss: 0.0021 - dice_multi: 0.9523
Epoch 84/100
400/400 - 533s - loss: 0.0011 - dice_multi: 0.9519
Epoch 85/100
400/400 - 533s - loss: 0.0027 - dice_multi: 0.9508
Epoch 86/100
400/400 - 533s - loss: 6.5743e-04 - dice_multi: 0.9528
Epoch 87/100
400/400 - 533s - loss: 0.0043 - dice_multi: 0.9467
Epoch 88/100
400/400 - 533s - loss: 0.0039 - dice_multi: 0.9517
Epoch 89/100
400/400 - 533s - loss: 0.0010 - dice_multi: 0.9526
Epoch 90/100
400/400 - 533s - loss: 0.0012 - dice_multi: 0.9522
Epoch 91/100
400/400 - 533s - loss: 7.0973e-04 - dice_multi: 0.9530
Epoch 92/100
400/400 - 533s - loss: 0.0023 - dice_multi: 0.9509
Epoch 93/100
400/400 - 533s - loss: 0.0057 - dice_multi: 0.9482
Epoch 94/100
400/400 - 533s - loss: 0.0012 - dice_multi: 0.9525
Epoch 95/100
400/400 - 533s - loss: 0.0070 - dice_multi: 0.9450
Epoch 96/100
400/400 - 533s - loss: 0.0052 - dice_multi: 0.9500
Epoch 97/100
400/400 - 533s - loss: 8.7504e-04 - dice_multi: 0.9529
Epoch 98/100
400/400 - 533s - loss: -5.0280e-04 - dice_multi: 0.9549
Epoch 99/100
400/400 - 533s - loss: 2.9182e-04 - dice_multi: 0.9528
Epoch 100/100
400/400 - 533s - loss: 4.5175e-04 - dice_multi: 0.9528
2022-01-28 03:51:42.168164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-28 03:51:42.182772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-28 03:51:42.184790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-28 03:51:42.184844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-28 03:51:42.184856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-28 03:51:42.184864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-28 03:51:42.184871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-28 03:51:42.186248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-28 03:51:42.186968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 53339.28227877617
executation time:146.26048702001572
---------fold--5---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47]
training set size:  48
testing set:  [48 49 50 51 52 53 54 55 56 57 58 59 60 61 62]
testing set size:  15
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 541s - loss: 0.1384 - dice_multi: 0.7073
Epoch 2/100
400/400 - 533s - loss: 0.0838 - dice_multi: 0.8060
Epoch 3/100
400/400 - 533s - loss: 0.0643 - dice_multi: 0.8444
Epoch 4/100
400/400 - 534s - loss: 0.0645 - dice_multi: 0.8521
Epoch 5/100
400/400 - 533s - loss: 0.0559 - dice_multi: 0.8716
Epoch 6/100
400/400 - 534s - loss: 0.0513 - dice_multi: 0.8763
Epoch 7/100
400/400 - 534s - loss: 0.0420 - dice_multi: 0.8940
Epoch 8/100
400/400 - 533s - loss: 0.0303 - dice_multi: 0.9117
Epoch 9/100
400/400 - 534s - loss: 0.0273 - dice_multi: 0.9178
Epoch 10/100
400/400 - 534s - loss: 0.0570 - dice_multi: 0.8667
Epoch 11/100
400/400 - 533s - loss: 0.0458 - dice_multi: 0.8996
Epoch 12/100
400/400 - 534s - loss: 0.0302 - dice_multi: 0.9175
Epoch 13/100
400/400 - 534s - loss: 0.0239 - dice_multi: 0.9283
Epoch 14/100
400/400 - 534s - loss: 0.0379 - dice_multi: 0.9039
Epoch 15/100
400/400 - 534s - loss: 0.0253 - dice_multi: 0.9273
Epoch 16/100
400/400 - 534s - loss: 0.0256 - dice_multi: 0.9253
Epoch 17/100
400/400 - 534s - loss: 0.0391 - dice_multi: 0.9049
Epoch 18/100
400/400 - 534s - loss: 0.0268 - dice_multi: 0.9226
Epoch 19/100
400/400 - 534s - loss: 0.0164 - dice_multi: 0.9385
Epoch 20/100
400/400 - 534s - loss: 0.0228 - dice_multi: 0.9278
Epoch 21/100
400/400 - 534s - loss: 0.0151 - dice_multi: 0.9367
Epoch 22/100
400/400 - 534s - loss: 0.0234 - dice_multi: 0.9283
Epoch 23/100
400/400 - 534s - loss: 0.0206 - dice_multi: 0.9318
Epoch 24/100
400/400 - 534s - loss: 0.0183 - dice_multi: 0.9329
Epoch 25/100
400/400 - 534s - loss: 0.0130 - dice_multi: 0.9402
Epoch 26/100
400/400 - 534s - loss: 0.0215 - dice_multi: 0.9304
Epoch 27/100
400/400 - 534s - loss: 0.0128 - dice_multi: 0.9437
Epoch 28/100
400/400 - 534s - loss: 0.0233 - dice_multi: 0.9295
Epoch 29/100
400/400 - 533s - loss: 0.0179 - dice_multi: 0.9387
Epoch 30/100
400/400 - 534s - loss: 0.0119 - dice_multi: 0.9439
Epoch 31/100
400/400 - 534s - loss: 0.0251 - dice_multi: 0.9240
Epoch 32/100
400/400 - 534s - loss: 0.0133 - dice_multi: 0.9418
Epoch 33/100
400/400 - 534s - loss: 0.0264 - dice_multi: 0.9271
Epoch 34/100
400/400 - 533s - loss: 0.0168 - dice_multi: 0.9394
Epoch 35/100
400/400 - 533s - loss: 0.0155 - dice_multi: 0.9403
Epoch 36/100
400/400 - 533s - loss: 0.0093 - dice_multi: 0.9457
Epoch 37/100
400/400 - 534s - loss: 0.0146 - dice_multi: 0.9388
Epoch 38/100
400/400 - 534s - loss: 0.0139 - dice_multi: 0.9425
Epoch 39/100
400/400 - 534s - loss: 0.0186 - dice_multi: 0.9385
Epoch 40/100
400/400 - 534s - loss: 0.0199 - dice_multi: 0.9355
Epoch 41/100
400/400 - 534s - loss: 0.0197 - dice_multi: 0.9365
Epoch 42/100
400/400 - 534s - loss: 0.0095 - dice_multi: 0.9463
Epoch 43/100
400/400 - 534s - loss: 0.0093 - dice_multi: 0.9463
Epoch 44/100
400/400 - 534s - loss: 0.0089 - dice_multi: 0.9460
Epoch 45/100
400/400 - 534s - loss: 0.0238 - dice_multi: 0.9281
Epoch 46/100
400/400 - 534s - loss: 0.0174 - dice_multi: 0.9397
Epoch 47/100
400/400 - 534s - loss: 0.0150 - dice_multi: 0.9430
Epoch 48/100
400/400 - 534s - loss: 0.0108 - dice_multi: 0.9470
Epoch 49/100
400/400 - 534s - loss: 0.0081 - dice_multi: 0.9482
Epoch 50/100
400/400 - 534s - loss: 0.0102 - dice_multi: 0.9453
Epoch 51/100
400/400 - 534s - loss: 0.0124 - dice_multi: 0.9430
Epoch 52/100
400/400 - 534s - loss: 0.0082 - dice_multi: 0.9492
Epoch 53/100
400/400 - 534s - loss: 0.0222 - dice_multi: 0.9339
Epoch 54/100
400/400 - 534s - loss: 0.0080 - dice_multi: 0.9481
Epoch 55/100
400/400 - 534s - loss: 0.0206 - dice_multi: 0.9354
Epoch 56/100
400/400 - 534s - loss: 0.0189 - dice_multi: 0.9405
Epoch 57/100
400/400 - 534s - loss: 0.0091 - dice_multi: 0.9476
Epoch 58/100
400/400 - 534s - loss: 0.0068 - dice_multi: 0.9504
Epoch 59/100
400/400 - 534s - loss: 0.0055 - dice_multi: 0.9505
Epoch 60/100
400/400 - 534s - loss: 0.0114 - dice_multi: 0.9413
Epoch 61/100
400/400 - 534s - loss: 0.0208 - dice_multi: 0.9398
Epoch 62/100
400/400 - 534s - loss: 0.0104 - dice_multi: 0.9466
Epoch 63/100
400/400 - 534s - loss: 0.0057 - dice_multi: 0.9508
Epoch 64/100
400/400 - 534s - loss: 0.0091 - dice_multi: 0.9451
Epoch 65/100
400/400 - 534s - loss: 0.0068 - dice_multi: 0.9491
Epoch 66/100
400/400 - 534s - loss: 0.0096 - dice_multi: 0.9443
Epoch 67/100
400/400 - 534s - loss: 0.0063 - dice_multi: 0.9506
Epoch 68/100
400/400 - 534s - loss: 0.0291 - dice_multi: 0.9287
Epoch 69/100
400/400 - 534s - loss: 0.0138 - dice_multi: 0.9461
Epoch 70/100
400/400 - 534s - loss: 0.0069 - dice_multi: 0.9506
Epoch 71/100
400/400 - 534s - loss: 0.0049 - dice_multi: 0.9512
Epoch 72/100
400/400 - 534s - loss: 0.0169 - dice_multi: 0.9393
Epoch 73/100
400/400 - 534s - loss: 0.0080 - dice_multi: 0.9504
Epoch 74/100
400/400 - 534s - loss: 0.0033 - dice_multi: 0.9514
Epoch 75/100
400/400 - 534s - loss: 0.0064 - dice_multi: 0.9502
Epoch 76/100
400/400 - 534s - loss: 0.0146 - dice_multi: 0.9416
Epoch 77/100
400/400 - 534s - loss: 0.0103 - dice_multi: 0.9478
Epoch 78/100
400/400 - 534s - loss: 0.0114 - dice_multi: 0.9429
Epoch 79/100
400/400 - 534s - loss: 0.0081 - dice_multi: 0.9480
Epoch 80/100
400/400 - 534s - loss: 0.0048 - dice_multi: 0.9503
Epoch 81/100
400/400 - 534s - loss: 0.0036 - dice_multi: 0.9501
Epoch 82/100
400/400 - 534s - loss: 0.0139 - dice_multi: 0.9423
Epoch 83/100
400/400 - 534s - loss: 0.0049 - dice_multi: 0.9522
Epoch 84/100
400/400 - 534s - loss: 0.0062 - dice_multi: 0.9505
Epoch 85/100
400/400 - 534s - loss: 0.0067 - dice_multi: 0.9504
Epoch 86/100
400/400 - 534s - loss: 0.0035 - dice_multi: 0.9539
Epoch 87/100
400/400 - 534s - loss: 0.0240 - dice_multi: 0.9296
Epoch 88/100
400/400 - 534s - loss: 0.0081 - dice_multi: 0.9495
Epoch 89/100
400/400 - 534s - loss: 0.0049 - dice_multi: 0.9529
Epoch 90/100
400/400 - 534s - loss: 0.0119 - dice_multi: 0.9444
Epoch 91/100
400/400 - 534s - loss: 0.0072 - dice_multi: 0.9510
Epoch 92/100
400/400 - 534s - loss: 0.0051 - dice_multi: 0.9514
Epoch 93/100
400/400 - 534s - loss: 0.0201 - dice_multi: 0.9368
Epoch 94/100
400/400 - 534s - loss: 0.0083 - dice_multi: 0.9502
Epoch 95/100
400/400 - 534s - loss: 0.0150 - dice_multi: 0.9434
Epoch 96/100
400/400 - 534s - loss: 0.0084 - dice_multi: 0.9497
Epoch 97/100
400/400 - 534s - loss: 0.0041 - dice_multi: 0.9538
Epoch 98/100
400/400 - 534s - loss: 0.0029 - dice_multi: 0.9532
Epoch 99/100
400/400 - 534s - loss: 0.0053 - dice_multi: 0.9499
Epoch 100/100
400/400 - 534s - loss: 0.0041 - dice_multi: 0.9527
training time: 53374.66427254677
executation time:145.45500237147013
[0.99867254 0.92606735]
