Bayesian U-Net
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2022-02-18 12:47:51.137899: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(98, 117, 159, 126)
2022-02-18 12:48:03.917204: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2022-02-18 12:48:03.955027: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-18 12:48:03.955864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-18 12:48:03.955898: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2022-02-18 12:48:03.961650: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2022-02-18 12:48:03.961716: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2022-02-18 12:48:03.964833: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2022-02-18 12:48:03.965436: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2022-02-18 12:48:03.966327: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2022-02-18 12:48:03.967559: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2022-02-18 12:48:03.968023: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2022-02-18 12:48:03.971324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-02-18 12:48:04.163427: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-18 12:48:04.164161: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-18 12:48:04.166883: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-02-18 12:48:04.166927: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2022-02-18 12:48:04.879255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-18 12:48:04.879313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-02-18 12:48:04.879328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-02-18 12:48:04.879336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-02-18 12:48:04.883386: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-02-18 12:48:04.884563: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2022-02-18 12:48:05.517162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-18 12:48:05.517953: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-18 12:48:05.519944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-02-18 12:48:05.519983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-18 12:48:05.519994: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-02-18 12:48:05.520002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-02-18 12:48:05.520009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-02-18 12:48:05.521425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-02-18 12:48:05.522131: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
---------fold--1---------
training set:  [19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42
 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66
 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90
 91 92 93 94]
training set size:  76
testing set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18]
testing set size:  19
..generator_len: 400
..training_n_subject: 76
..training_n_patch_per_sub: 326592
2022-02-18 12:48:07.156911: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-02-18 12:48:07.157472: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2400085000 Hz
2022-02-18 12:48:10.983366: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2022-02-18 12:48:11.358629: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2022-02-18 12:48:11.835787: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2022-02-18 12:48:12.097844: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 556s - loss: 0.1207 - dice_multi: 0.6624
Epoch 2/100
400/400 - 510s - loss: 0.0869 - dice_multi: 0.7509
Epoch 3/100
400/400 - 510s - loss: 0.0727 - dice_multi: 0.7910
Epoch 4/100
400/400 - 509s - loss: 0.0625 - dice_multi: 0.8242
Epoch 5/100
400/400 - 509s - loss: 0.0547 - dice_multi: 0.8485
Epoch 6/100
400/400 - 510s - loss: 0.0370 - dice_multi: 0.8850
Epoch 7/100
400/400 - 510s - loss: 0.0332 - dice_multi: 0.9035
Epoch 8/100
400/400 - 510s - loss: 0.0208 - dice_multi: 0.9319
Epoch 9/100
400/400 - 510s - loss: 0.0239 - dice_multi: 0.9264
Epoch 10/100
400/400 - 510s - loss: 0.0186 - dice_multi: 0.9397
Epoch 11/100
400/400 - 510s - loss: 0.0178 - dice_multi: 0.9413
Epoch 12/100
400/400 - 510s - loss: 0.0180 - dice_multi: 0.9409
Epoch 13/100
400/400 - 510s - loss: 0.0180 - dice_multi: 0.9403
Epoch 14/100
400/400 - 510s - loss: 0.0186 - dice_multi: 0.9398
Epoch 15/100
400/400 - 510s - loss: 0.0320 - dice_multi: 0.9112
Epoch 16/100
400/400 - 510s - loss: 0.0163 - dice_multi: 0.9463
Epoch 17/100
400/400 - 510s - loss: 0.0231 - dice_multi: 0.9299
Epoch 18/100
400/400 - 510s - loss: 0.0177 - dice_multi: 0.9426
Epoch 19/100
400/400 - 510s - loss: 0.0163 - dice_multi: 0.9468
Epoch 20/100
400/400 - 510s - loss: 0.0151 - dice_multi: 0.9500
Epoch 21/100
400/400 - 510s - loss: 0.0154 - dice_multi: 0.9498
Epoch 22/100
400/400 - 510s - loss: 0.0143 - dice_multi: 0.9533
Epoch 23/100
400/400 - 510s - loss: 0.0149 - dice_multi: 0.9519
Epoch 24/100
400/400 - 510s - loss: 0.0160 - dice_multi: 0.9492
Epoch 25/100
400/400 - 510s - loss: 0.0144 - dice_multi: 0.9533
Epoch 26/100
400/400 - 510s - loss: 0.0156 - dice_multi: 0.9471
Epoch 27/100
400/400 - 510s - loss: 0.0134 - dice_multi: 0.9551
Epoch 28/100
400/400 - 509s - loss: 0.0137 - dice_multi: 0.9565
Epoch 29/100
400/400 - 509s - loss: 0.0141 - dice_multi: 0.9547
Epoch 30/100
400/400 - 510s - loss: 0.0129 - dice_multi: 0.9567
Epoch 31/100
400/400 - 510s - loss: 0.0130 - dice_multi: 0.9572
Epoch 32/100
400/400 - 510s - loss: 0.0135 - dice_multi: 0.9571
Epoch 33/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9581
Epoch 34/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9575
Epoch 35/100
400/400 - 510s - loss: 0.0167 - dice_multi: 0.9476
Epoch 36/100
400/400 - 510s - loss: 0.0131 - dice_multi: 0.9554
Epoch 37/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9569
Epoch 38/100
400/400 - 510s - loss: 0.0127 - dice_multi: 0.9559
Epoch 39/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9581
Epoch 40/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9594
Epoch 41/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9602
Epoch 42/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9595
Epoch 43/100
400/400 - 510s - loss: 0.0119 - dice_multi: 0.9604
Epoch 44/100
400/400 - 510s - loss: 0.0336 - dice_multi: 0.9074
Epoch 45/100
400/400 - 510s - loss: 0.0147 - dice_multi: 0.9518
Epoch 46/100
400/400 - 510s - loss: 0.0130 - dice_multi: 0.9551
Epoch 47/100
400/400 - 510s - loss: 0.0130 - dice_multi: 0.9568
Epoch 48/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9578
Epoch 49/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9596
Epoch 50/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9591
Epoch 51/100
400/400 - 510s - loss: 0.0156 - dice_multi: 0.9525
Epoch 52/100
400/400 - 510s - loss: 0.0133 - dice_multi: 0.9567
Epoch 53/100
400/400 - 510s - loss: 0.0121 - dice_multi: 0.9591
Epoch 54/100
400/400 - 510s - loss: 0.0122 - dice_multi: 0.9591
Epoch 55/100
400/400 - 510s - loss: 0.0121 - dice_multi: 0.9606
Epoch 56/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9601
Epoch 57/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9605
Epoch 58/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9609
Epoch 59/100
400/400 - 509s - loss: 0.0116 - dice_multi: 0.9609
Epoch 60/100
400/400 - 509s - loss: 0.0111 - dice_multi: 0.9619
Epoch 61/100
400/400 - 510s - loss: 0.0167 - dice_multi: 0.9473
Epoch 62/100
400/400 - 510s - loss: 0.0119 - dice_multi: 0.9588
Epoch 63/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9596
Epoch 64/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9615
Epoch 65/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9612
Epoch 66/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9628
Epoch 67/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9621
Epoch 68/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9626
Epoch 69/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9587
Epoch 70/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9616
Epoch 71/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9624
Epoch 72/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9635
Epoch 73/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9638
Epoch 74/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9645
Epoch 75/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9637
Epoch 76/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9636
Epoch 77/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9639
Epoch 78/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9643
Epoch 79/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9649
Epoch 80/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9645
Epoch 81/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9648
Epoch 82/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9622
Epoch 83/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9604
Epoch 84/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9643
Epoch 85/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9649
Epoch 86/100
400/400 - 511s - loss: 0.0103 - dice_multi: 0.9648
Epoch 87/100
400/400 - 511s - loss: 0.0101 - dice_multi: 0.9646
Epoch 88/100
400/400 - 510s - loss: 0.0104 - dice_multi: 0.9650
Epoch 89/100
400/400 - 510s - loss: 0.0100 - dice_multi: 0.9657
Epoch 90/100
400/400 - 510s - loss: 0.0100 - dice_multi: 0.9657
Epoch 91/100
400/400 - 510s - loss: 0.0104 - dice_multi: 0.9650
Epoch 92/100
400/400 - 510s - loss: 0.0101 - dice_multi: 0.9661
Epoch 93/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9641
Epoch 94/100
400/400 - 510s - loss: 0.0097 - dice_multi: 0.9652
Epoch 95/100
400/400 - 510s - loss: 0.0099 - dice_multi: 0.9661
Epoch 96/100
400/400 - 510s - loss: 0.0097 - dice_multi: 0.9662
Epoch 97/100
400/400 - 510s - loss: 0.0098 - dice_multi: 0.9659
Epoch 98/100
400/400 - 511s - loss: 0.0099 - dice_multi: 0.9674
Epoch 99/100
400/400 - 511s - loss: 0.0109 - dice_multi: 0.9630
Epoch 100/100
400/400 - 511s - loss: 0.0104 - dice_multi: 0.9662
2022-02-19 03:42:57.122614: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-19 03:42:57.154095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-19 03:42:57.156083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-02-19 03:42:57.156138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-19 03:42:57.156150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-02-19 03:42:57.156158: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-02-19 03:42:57.156165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-02-19 03:42:57.157543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-02-19 03:42:57.158257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 51043.04761314392
executation time:139.00195584799113
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 38 39 40 41 42
 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66
 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90
 91 92 93 94]
training set size:  76
testing set:  [19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37]
testing set size:  19
..generator_len: 400
..training_n_subject: 76
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 514s - loss: 0.1268 - dice_multi: 0.6725
Epoch 2/100
400/400 - 510s - loss: 0.0637 - dice_multi: 0.7980
Epoch 3/100
400/400 - 510s - loss: 0.0471 - dice_multi: 0.8441
Epoch 4/100
400/400 - 510s - loss: 0.0418 - dice_multi: 0.8707
Epoch 5/100
400/400 - 510s - loss: 0.0371 - dice_multi: 0.8786
Epoch 6/100
400/400 - 511s - loss: 0.0280 - dice_multi: 0.9105
Epoch 7/100
400/400 - 511s - loss: 0.0262 - dice_multi: 0.9164
Epoch 8/100
400/400 - 511s - loss: 0.0193 - dice_multi: 0.9294
Epoch 9/100
400/400 - 511s - loss: 0.0239 - dice_multi: 0.9187
Epoch 10/100
400/400 - 510s - loss: 0.0161 - dice_multi: 0.9418
Epoch 11/100
400/400 - 510s - loss: 0.0150 - dice_multi: 0.9460
Epoch 12/100
400/400 - 510s - loss: 0.0350 - dice_multi: 0.8955
Epoch 13/100
400/400 - 511s - loss: 0.0176 - dice_multi: 0.9389
Epoch 14/100
400/400 - 511s - loss: 0.0145 - dice_multi: 0.9474
Epoch 15/100
400/400 - 511s - loss: 0.0200 - dice_multi: 0.9319
Epoch 16/100
400/400 - 510s - loss: 0.0142 - dice_multi: 0.9495
Epoch 17/100
400/400 - 510s - loss: 0.0233 - dice_multi: 0.9258
Epoch 18/100
400/400 - 510s - loss: 0.0150 - dice_multi: 0.9463
Epoch 19/100
400/400 - 510s - loss: 0.0159 - dice_multi: 0.9436
Epoch 20/100
400/400 - 510s - loss: 0.0157 - dice_multi: 0.9478
Epoch 21/100
400/400 - 510s - loss: 0.0147 - dice_multi: 0.9467
Epoch 22/100
400/400 - 510s - loss: 0.0134 - dice_multi: 0.9528
Epoch 23/100
400/400 - 510s - loss: 0.0135 - dice_multi: 0.9523
Epoch 24/100
400/400 - 510s - loss: 0.0129 - dice_multi: 0.9545
Epoch 25/100
400/400 - 510s - loss: 0.0131 - dice_multi: 0.9533
Epoch 26/100
400/400 - 511s - loss: 0.0130 - dice_multi: 0.9529
Epoch 27/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9556
Epoch 28/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9533
Epoch 29/100
400/400 - 510s - loss: 0.0166 - dice_multi: 0.9433
Epoch 30/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9556
Epoch 31/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9560
Epoch 32/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9567
Epoch 33/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9562
Epoch 34/100
400/400 - 510s - loss: 0.0165 - dice_multi: 0.9453
Epoch 35/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9574
Epoch 36/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9567
Epoch 37/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9587
Epoch 38/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9580
Epoch 39/100
400/400 - 510s - loss: 0.0141 - dice_multi: 0.9494
Epoch 40/100
400/400 - 510s - loss: 0.0129 - dice_multi: 0.9549
Epoch 41/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9581
Epoch 42/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9598
Epoch 43/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9611
Epoch 44/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9605
Epoch 45/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9603
Epoch 46/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9592
Epoch 47/100
400/400 - 511s - loss: 0.0112 - dice_multi: 0.9601
Epoch 48/100
400/400 - 511s - loss: 0.0109 - dice_multi: 0.9608
Epoch 49/100
400/400 - 511s - loss: 0.0128 - dice_multi: 0.9548
Epoch 50/100
400/400 - 511s - loss: 0.0109 - dice_multi: 0.9614
Epoch 51/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9615
Epoch 52/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9629
Epoch 53/100
400/400 - 511s - loss: 0.0105 - dice_multi: 0.9613
Epoch 54/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9612
Epoch 55/100
400/400 - 510s - loss: 0.0122 - dice_multi: 0.9576
Epoch 56/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9532
Epoch 57/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9562
Epoch 58/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9599
Epoch 59/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9625
Epoch 60/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9624
Epoch 61/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9622
Epoch 62/100
400/400 - 510s - loss: 0.0103 - dice_multi: 0.9624
Epoch 63/100
400/400 - 511s - loss: 0.0102 - dice_multi: 0.9620
Epoch 64/100
400/400 - 510s - loss: 0.0101 - dice_multi: 0.9634
Epoch 65/100
400/400 - 510s - loss: 0.0130 - dice_multi: 0.9553
Epoch 66/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9624
Epoch 67/100
400/400 - 510s - loss: 0.0104 - dice_multi: 0.9630
Epoch 68/100
400/400 - 510s - loss: 0.0101 - dice_multi: 0.9633
Epoch 69/100
400/400 - 510s - loss: 0.0102 - dice_multi: 0.9627
Epoch 70/100
400/400 - 510s - loss: 0.0099 - dice_multi: 0.9640
Epoch 71/100
400/400 - 510s - loss: 0.0100 - dice_multi: 0.9638
Epoch 72/100
400/400 - 510s - loss: 0.0097 - dice_multi: 0.9641
Epoch 73/100
400/400 - 510s - loss: 0.0095 - dice_multi: 0.9641
Epoch 74/100
400/400 - 510s - loss: 0.0103 - dice_multi: 0.9629
Epoch 75/100
400/400 - 510s - loss: 0.0100 - dice_multi: 0.9638
Epoch 76/100
400/400 - 510s - loss: 0.0098 - dice_multi: 0.9648
Epoch 77/100
400/400 - 510s - loss: 0.0097 - dice_multi: 0.9656
Epoch 78/100
400/400 - 510s - loss: 0.0097 - dice_multi: 0.9651
Epoch 79/100
400/400 - 510s - loss: 0.0096 - dice_multi: 0.9649
Epoch 80/100
400/400 - 510s - loss: 0.0099 - dice_multi: 0.9649
Epoch 81/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9626
Epoch 82/100
400/400 - 510s - loss: 0.0172 - dice_multi: 0.9439
Epoch 83/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9613
Epoch 84/100
400/400 - 510s - loss: 0.0103 - dice_multi: 0.9625
Epoch 85/100
400/400 - 510s - loss: 0.0098 - dice_multi: 0.9638
Epoch 86/100
400/400 - 510s - loss: 0.0098 - dice_multi: 0.9649
Epoch 87/100
400/400 - 510s - loss: 0.0094 - dice_multi: 0.9646
Epoch 88/100
400/400 - 511s - loss: 0.0093 - dice_multi: 0.9651
Epoch 89/100
400/400 - 511s - loss: 0.0097 - dice_multi: 0.9658
Epoch 90/100
400/400 - 511s - loss: 0.0095 - dice_multi: 0.9661
Epoch 91/100
400/400 - 511s - loss: 0.0107 - dice_multi: 0.9628
Epoch 92/100
400/400 - 511s - loss: 0.0093 - dice_multi: 0.9648
Epoch 93/100
400/400 - 510s - loss: 0.0093 - dice_multi: 0.9658
Epoch 94/100
400/400 - 510s - loss: 0.0093 - dice_multi: 0.9675
Epoch 95/100
400/400 - 510s - loss: 0.0094 - dice_multi: 0.9668
Epoch 96/100
400/400 - 510s - loss: 0.0091 - dice_multi: 0.9671
Epoch 97/100
400/400 - 510s - loss: 0.0091 - dice_multi: 0.9660
Epoch 98/100
400/400 - 510s - loss: 0.0090 - dice_multi: 0.9665
Epoch 99/100
400/400 - 511s - loss: 0.0093 - dice_multi: 0.9667
Epoch 100/100
400/400 - 511s - loss: 0.0094 - dice_multi: 0.9672
2022-02-19 18:37:39.502765: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-19 18:37:39.528263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-19 18:37:39.530292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-02-19 18:37:39.530374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-19 18:37:39.530387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-02-19 18:37:39.530395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-02-19 18:37:39.530402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-02-19 18:37:39.531948: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-02-19 18:37:39.532664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 51040.53737902641
executation time:138.62583701234115
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 57 58 59 60 61 62 63 64 65 66
 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90
 91 92 93 94]
training set size:  76
testing set:  [38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56]
testing set size:  19
..generator_len: 400
..training_n_subject: 76
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 514s - loss: 0.1622 - dice_multi: 0.6354
Epoch 2/100
400/400 - 510s - loss: 0.0859 - dice_multi: 0.7527
Epoch 3/100
400/400 - 510s - loss: 0.0639 - dice_multi: 0.8077
Epoch 4/100
400/400 - 510s - loss: 0.0494 - dice_multi: 0.8414
Epoch 5/100
400/400 - 510s - loss: 0.0491 - dice_multi: 0.8505
Epoch 6/100
400/400 - 510s - loss: 0.0358 - dice_multi: 0.8884
Epoch 7/100
400/400 - 511s - loss: 0.0345 - dice_multi: 0.8883
Epoch 8/100
400/400 - 510s - loss: 0.0242 - dice_multi: 0.9189
Epoch 9/100
400/400 - 510s - loss: 0.0188 - dice_multi: 0.9332
Epoch 10/100
400/400 - 510s - loss: 0.0229 - dice_multi: 0.9263
Epoch 11/100
400/400 - 511s - loss: 0.0184 - dice_multi: 0.9350
Epoch 12/100
400/400 - 511s - loss: 0.0293 - dice_multi: 0.9088
Epoch 13/100
400/400 - 510s - loss: 0.0193 - dice_multi: 0.9347
Epoch 14/100
400/400 - 509s - loss: 0.0168 - dice_multi: 0.9444
Epoch 15/100
400/400 - 510s - loss: 0.0156 - dice_multi: 0.9449
Epoch 16/100
400/400 - 510s - loss: 0.0336 - dice_multi: 0.9055
Epoch 17/100
400/400 - 510s - loss: 0.0185 - dice_multi: 0.9373
Epoch 18/100
400/400 - 510s - loss: 0.0173 - dice_multi: 0.9419
Epoch 19/100
400/400 - 509s - loss: 0.0153 - dice_multi: 0.9469
Epoch 20/100
400/400 - 510s - loss: 0.0145 - dice_multi: 0.9479
Epoch 21/100
400/400 - 510s - loss: 0.0139 - dice_multi: 0.9499
Epoch 22/100
400/400 - 510s - loss: 0.0164 - dice_multi: 0.9452
Epoch 23/100
400/400 - 510s - loss: 0.0151 - dice_multi: 0.9484
Epoch 24/100
400/400 - 510s - loss: 0.0145 - dice_multi: 0.9513
Epoch 25/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9539
Epoch 26/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9533
Epoch 27/100
400/400 - 510s - loss: 0.0143 - dice_multi: 0.9522
Epoch 28/100
400/400 - 510s - loss: 0.0145 - dice_multi: 0.9518
Epoch 29/100
400/400 - 510s - loss: 0.0264 - dice_multi: 0.9220
Epoch 30/100
400/400 - 510s - loss: 0.0157 - dice_multi: 0.9447
Epoch 31/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9512
Epoch 32/100
400/400 - 510s - loss: 0.0132 - dice_multi: 0.9558
Epoch 33/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9557
Epoch 34/100
400/400 - 510s - loss: 0.0218 - dice_multi: 0.9331
Epoch 35/100
400/400 - 510s - loss: 0.0145 - dice_multi: 0.9491
Epoch 36/100
400/400 - 510s - loss: 0.0134 - dice_multi: 0.9550
Epoch 37/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9549
Epoch 38/100
400/400 - 510s - loss: 0.0143 - dice_multi: 0.9510
Epoch 39/100
400/400 - 510s - loss: 0.0128 - dice_multi: 0.9546
Epoch 40/100
400/400 - 510s - loss: 0.0147 - dice_multi: 0.9528
Epoch 41/100
400/400 - 510s - loss: 0.0187 - dice_multi: 0.9354
Epoch 42/100
400/400 - 510s - loss: 0.0130 - dice_multi: 0.9539
Epoch 43/100
400/400 - 510s - loss: 0.0129 - dice_multi: 0.9554
Epoch 44/100
400/400 - 510s - loss: 0.0208 - dice_multi: 0.9361
Epoch 45/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9543
Epoch 46/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9553
Epoch 47/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9566
Epoch 48/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9581
Epoch 49/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9581
Epoch 50/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9575
Epoch 51/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9583
Epoch 52/100
400/400 - 510s - loss: 0.0122 - dice_multi: 0.9599
Epoch 53/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9581
Epoch 54/100
400/400 - 510s - loss: 0.0134 - dice_multi: 0.9528
Epoch 55/100
400/400 - 510s - loss: 0.0157 - dice_multi: 0.9503
Epoch 56/100
400/400 - 510s - loss: 0.0140 - dice_multi: 0.9538
Epoch 57/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9570
Epoch 58/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9583
Epoch 59/100
400/400 - 510s - loss: 0.0119 - dice_multi: 0.9598
Epoch 60/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9584
Epoch 61/100
400/400 - 510s - loss: 0.0122 - dice_multi: 0.9580
Epoch 62/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9597
Epoch 63/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9615
Epoch 64/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9610
Epoch 65/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9610
Epoch 66/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9602
Epoch 67/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9620
Epoch 68/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9607
Epoch 69/100
400/400 - 510s - loss: 0.0159 - dice_multi: 0.9495
Epoch 70/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9597
Epoch 71/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9614
Epoch 72/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9612
Epoch 73/100
400/400 - 510s - loss: 0.0131 - dice_multi: 0.9562
Epoch 74/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9600
Epoch 75/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9614
Epoch 76/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9624
Epoch 77/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9617
Epoch 78/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9620
Epoch 79/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9628
Epoch 80/100
400/400 - 510s - loss: 0.0103 - dice_multi: 0.9624
Epoch 81/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9619
Epoch 82/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9595
Epoch 83/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9625
Epoch 84/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9631
Epoch 85/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9628
Epoch 86/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9635
Epoch 87/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9587
Epoch 88/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9635
Epoch 89/100
400/400 - 510s - loss: 0.0103 - dice_multi: 0.9644
Epoch 90/100
400/400 - 510s - loss: 0.0098 - dice_multi: 0.9648
Epoch 91/100
400/400 - 510s - loss: 0.0101 - dice_multi: 0.9645
Epoch 92/100
400/400 - 510s - loss: 0.0103 - dice_multi: 0.9640
Epoch 93/100
400/400 - 511s - loss: 0.0099 - dice_multi: 0.9641
Epoch 94/100
400/400 - 511s - loss: 0.0101 - dice_multi: 0.9644
Epoch 95/100
400/400 - 511s - loss: 0.0103 - dice_multi: 0.9643
Epoch 96/100
400/400 - 511s - loss: 0.0102 - dice_multi: 0.9646
Epoch 97/100
400/400 - 511s - loss: 0.0100 - dice_multi: 0.9650
Epoch 98/100
400/400 - 511s - loss: 0.0100 - dice_multi: 0.9652
Epoch 99/100
400/400 - 511s - loss: 0.0099 - dice_multi: 0.9662
Epoch 100/100
400/400 - 511s - loss: 0.0098 - dice_multi: 0.9650
2022-02-20 09:31:47.766561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-20 09:31:47.786587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-20 09:31:47.788577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-02-20 09:31:47.788634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-20 09:31:47.788646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-02-20 09:31:47.788654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-02-20 09:31:47.788661: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-02-20 09:31:47.790046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-02-20 09:31:47.790763: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 51018.005464076996
executation time:137.97104003554895
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
 48 49 50 51 52 53 54 55 56 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90
 91 92 93 94]
training set size:  76
testing set:  [57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75]
testing set size:  19
..generator_len: 400
..training_n_subject: 76
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 514s - loss: 0.1126 - dice_multi: 0.7056
Epoch 2/100
400/400 - 510s - loss: 0.0661 - dice_multi: 0.8080
Epoch 3/100
400/400 - 510s - loss: 0.0543 - dice_multi: 0.8481
Epoch 4/100
400/400 - 510s - loss: 0.0448 - dice_multi: 0.8741
Epoch 5/100
400/400 - 510s - loss: 0.0313 - dice_multi: 0.9075
Epoch 6/100
400/400 - 510s - loss: 0.0331 - dice_multi: 0.9016
Epoch 7/100
400/400 - 510s - loss: 0.0319 - dice_multi: 0.9105
Epoch 8/100
400/400 - 510s - loss: 0.0279 - dice_multi: 0.9138
Epoch 9/100
400/400 - 510s - loss: 0.0193 - dice_multi: 0.9363
Epoch 10/100
400/400 - 510s - loss: 0.0207 - dice_multi: 0.9360
Epoch 11/100
400/400 - 510s - loss: 0.0192 - dice_multi: 0.9402
Epoch 12/100
400/400 - 510s - loss: 0.0172 - dice_multi: 0.9430
Epoch 13/100
400/400 - 510s - loss: 0.0169 - dice_multi: 0.9461
Epoch 14/100
400/400 - 510s - loss: 0.0164 - dice_multi: 0.9482
Epoch 15/100
400/400 - 510s - loss: 0.0199 - dice_multi: 0.9376
Epoch 16/100
400/400 - 510s - loss: 0.0153 - dice_multi: 0.9497
Epoch 17/100
400/400 - 510s - loss: 0.0158 - dice_multi: 0.9490
Epoch 18/100
400/400 - 510s - loss: 0.0145 - dice_multi: 0.9513
Epoch 19/100
400/400 - 510s - loss: 0.0190 - dice_multi: 0.9419
Epoch 20/100
400/400 - 510s - loss: 0.0243 - dice_multi: 0.9244
Epoch 21/100
400/400 - 510s - loss: 0.0217 - dice_multi: 0.9344
Epoch 22/100
400/400 - 510s - loss: 0.0152 - dice_multi: 0.9514
Epoch 23/100
400/400 - 510s - loss: 0.0146 - dice_multi: 0.9531
Epoch 24/100
400/400 - 510s - loss: 0.0157 - dice_multi: 0.9517
Epoch 25/100
400/400 - 510s - loss: 0.0141 - dice_multi: 0.9533
Epoch 26/100
400/400 - 510s - loss: 0.0143 - dice_multi: 0.9552
Epoch 27/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9535
Epoch 28/100
400/400 - 510s - loss: 0.0252 - dice_multi: 0.9298
Epoch 29/100
400/400 - 510s - loss: 0.0162 - dice_multi: 0.9482
Epoch 30/100
400/400 - 510s - loss: 0.0200 - dice_multi: 0.9399
Epoch 31/100
400/400 - 510s - loss: 0.0145 - dice_multi: 0.9536
Epoch 32/100
400/400 - 510s - loss: 0.0141 - dice_multi: 0.9535
Epoch 33/100
400/400 - 510s - loss: 0.0134 - dice_multi: 0.9561
Epoch 34/100
400/400 - 510s - loss: 0.0159 - dice_multi: 0.9497
Epoch 35/100
400/400 - 510s - loss: 0.0138 - dice_multi: 0.9554
Epoch 36/100
400/400 - 510s - loss: 0.0133 - dice_multi: 0.9556
Epoch 37/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9564
Epoch 38/100
400/400 - 510s - loss: 0.0131 - dice_multi: 0.9576
Epoch 39/100
400/400 - 510s - loss: 0.0128 - dice_multi: 0.9576
Epoch 40/100
400/400 - 510s - loss: 0.0127 - dice_multi: 0.9563
Epoch 41/100
400/400 - 510s - loss: 0.0129 - dice_multi: 0.9573
Epoch 42/100
400/400 - 510s - loss: 0.0225 - dice_multi: 0.9354
Epoch 43/100
400/400 - 510s - loss: 0.0141 - dice_multi: 0.9532
Epoch 44/100
400/400 - 510s - loss: 0.0139 - dice_multi: 0.9567
Epoch 45/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9567
Epoch 46/100
400/400 - 511s - loss: 0.0126 - dice_multi: 0.9585
Epoch 47/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9591
Epoch 48/100
400/400 - 510s - loss: 0.0132 - dice_multi: 0.9589
Epoch 49/100
400/400 - 511s - loss: 0.0142 - dice_multi: 0.9536
Epoch 50/100
400/400 - 511s - loss: 0.0124 - dice_multi: 0.9581
Epoch 51/100
400/400 - 511s - loss: 0.0124 - dice_multi: 0.9583
Epoch 52/100
400/400 - 511s - loss: 0.0148 - dice_multi: 0.9558
Epoch 53/100
400/400 - 511s - loss: 0.0158 - dice_multi: 0.9483
Epoch 54/100
400/400 - 511s - loss: 0.0133 - dice_multi: 0.9570
Epoch 55/100
400/400 - 511s - loss: 0.0125 - dice_multi: 0.9565
Epoch 56/100
400/400 - 511s - loss: 0.0120 - dice_multi: 0.9601
Epoch 57/100
400/400 - 511s - loss: 0.0123 - dice_multi: 0.9593
Epoch 58/100
400/400 - 511s - loss: 0.0127 - dice_multi: 0.9591
Epoch 59/100
400/400 - 510s - loss: 0.0127 - dice_multi: 0.9588
Epoch 60/100
400/400 - 510s - loss: 0.0119 - dice_multi: 0.9597
Epoch 61/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9600
Epoch 62/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9602
Epoch 63/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9601
Epoch 64/100
400/400 - 510s - loss: 0.0119 - dice_multi: 0.9607
Epoch 65/100
400/400 - 511s - loss: 0.0117 - dice_multi: 0.9610
Epoch 66/100
400/400 - 511s - loss: 0.0115 - dice_multi: 0.9619
Epoch 67/100
400/400 - 511s - loss: 0.0117 - dice_multi: 0.9625
Epoch 68/100
400/400 - 511s - loss: 0.0118 - dice_multi: 0.9618
Epoch 69/100
400/400 - 511s - loss: 0.0319 - dice_multi: 0.9363
Epoch 70/100
400/400 - 511s - loss: 0.0125 - dice_multi: 0.9577
Epoch 71/100
400/400 - 510s - loss: 0.0122 - dice_multi: 0.9595
Epoch 72/100
400/400 - 511s - loss: 0.0121 - dice_multi: 0.9603
Epoch 73/100
400/400 - 511s - loss: 0.0117 - dice_multi: 0.9611
Epoch 74/100
400/400 - 511s - loss: 0.0117 - dice_multi: 0.9611
Epoch 75/100
400/400 - 511s - loss: 0.0114 - dice_multi: 0.9621
Epoch 76/100
400/400 - 511s - loss: 0.0117 - dice_multi: 0.9620
Epoch 77/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9624
Epoch 78/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9620
Epoch 79/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9626
Epoch 80/100
400/400 - 511s - loss: 0.0111 - dice_multi: 0.9636
Epoch 81/100
400/400 - 511s - loss: 0.0136 - dice_multi: 0.9564
Epoch 82/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9617
Epoch 83/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9628
Epoch 84/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9640
Epoch 85/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9636
Epoch 86/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9639
Epoch 87/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9648
Epoch 88/100
400/400 - 510s - loss: 0.0172 - dice_multi: 0.9554
Epoch 89/100
400/400 - 510s - loss: 0.0154 - dice_multi: 0.9499
Epoch 90/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9601
Epoch 91/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9619
Epoch 92/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9640
Epoch 93/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9635
Epoch 94/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9639
Epoch 95/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9648
Epoch 96/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9646
Epoch 97/100
400/400 - 510s - loss: 0.0104 - dice_multi: 0.9649
Epoch 98/100
400/400 - 511s - loss: 0.0123 - dice_multi: 0.9605
Epoch 99/100
400/400 - 511s - loss: 0.0203 - dice_multi: 0.9497
Epoch 100/100
400/400 - 510s - loss: 0.0135 - dice_multi: 0.9559
2022-02-21 00:26:20.307931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-21 00:26:20.334717: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-02-21 00:26:20.336789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-02-21 00:26:20.336844: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-21 00:26:20.336856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-02-21 00:26:20.336864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-02-21 00:26:20.336871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-02-21 00:26:20.338295: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-02-21 00:26:20.339007: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 51027.19375872612
executation time:138.8270619542975
---------fold--5---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47
 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71
 72 73 74 75]
training set size:  76
testing set:  [76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97]
testing set size:  22
..generator_len: 400
..training_n_subject: 76
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 514s - loss: 0.1123 - dice_multi: 0.7077
Epoch 2/100
400/400 - 511s - loss: 0.0786 - dice_multi: 0.7897
Epoch 3/100
400/400 - 511s - loss: 0.0552 - dice_multi: 0.8451
Epoch 4/100
400/400 - 511s - loss: 0.0441 - dice_multi: 0.8699
Epoch 5/100
400/400 - 511s - loss: 0.0379 - dice_multi: 0.8900
Epoch 6/100
400/400 - 511s - loss: 0.0345 - dice_multi: 0.9047
Epoch 7/100
400/400 - 511s - loss: 0.0292 - dice_multi: 0.9151
Epoch 8/100
400/400 - 511s - loss: 0.0194 - dice_multi: 0.9402
Epoch 9/100
400/400 - 511s - loss: 0.0231 - dice_multi: 0.9302
Epoch 10/100
400/400 - 511s - loss: 0.0181 - dice_multi: 0.9454
Epoch 11/100
400/400 - 510s - loss: 0.0228 - dice_multi: 0.9346
Epoch 12/100
400/400 - 511s - loss: 0.0170 - dice_multi: 0.9465
Epoch 13/100
400/400 - 511s - loss: 0.0261 - dice_multi: 0.9249
Epoch 14/100
400/400 - 511s - loss: 0.0173 - dice_multi: 0.9462
Epoch 15/100
400/400 - 511s - loss: 0.0157 - dice_multi: 0.9513
Epoch 16/100
400/400 - 511s - loss: 0.0157 - dice_multi: 0.9531
Epoch 17/100
400/400 - 511s - loss: 0.0150 - dice_multi: 0.9519
Epoch 18/100
400/400 - 511s - loss: 0.0250 - dice_multi: 0.9279
Epoch 19/100
400/400 - 511s - loss: 0.0170 - dice_multi: 0.9488
Epoch 20/100
400/400 - 511s - loss: 0.0154 - dice_multi: 0.9531
Epoch 21/100
400/400 - 511s - loss: 0.0164 - dice_multi: 0.9511
Epoch 22/100
400/400 - 511s - loss: 0.0144 - dice_multi: 0.9549
Epoch 23/100
400/400 - 511s - loss: 0.0144 - dice_multi: 0.9551
Epoch 24/100
400/400 - 511s - loss: 0.0144 - dice_multi: 0.9544
Epoch 25/100
400/400 - 511s - loss: 0.0146 - dice_multi: 0.9559
Epoch 26/100
400/400 - 511s - loss: 0.0140 - dice_multi: 0.9558
Epoch 27/100
400/400 - 511s - loss: 0.0156 - dice_multi: 0.9530
Epoch 28/100
400/400 - 510s - loss: 0.0203 - dice_multi: 0.9357
Epoch 29/100
400/400 - 511s - loss: 0.0154 - dice_multi: 0.9533
Epoch 30/100
400/400 - 511s - loss: 0.0135 - dice_multi: 0.9548
Epoch 31/100
400/400 - 511s - loss: 0.0213 - dice_multi: 0.9408
Epoch 32/100
400/400 - 511s - loss: 0.0151 - dice_multi: 0.9542
Epoch 33/100
400/400 - 511s - loss: 0.0139 - dice_multi: 0.9569
Epoch 34/100
400/400 - 511s - loss: 0.0136 - dice_multi: 0.9567
Epoch 35/100
400/400 - 511s - loss: 0.0130 - dice_multi: 0.9578
Epoch 36/100
400/400 - 511s - loss: 0.0132 - dice_multi: 0.9573
Epoch 37/100
400/400 - 511s - loss: 0.0131 - dice_multi: 0.9579
Epoch 38/100
400/400 - 511s - loss: 0.0156 - dice_multi: 0.9527
Epoch 39/100
400/400 - 511s - loss: 0.0136 - dice_multi: 0.9571
Epoch 40/100
400/400 - 511s - loss: 0.0133 - dice_multi: 0.9578
Epoch 41/100
400/400 - 511s - loss: 0.0130 - dice_multi: 0.9591
Epoch 42/100
400/400 - 511s - loss: 0.0127 - dice_multi: 0.9589
Epoch 43/100
400/400 - 511s - loss: 0.0131 - dice_multi: 0.9585
Epoch 44/100
400/400 - 511s - loss: 0.0131 - dice_multi: 0.9581
Epoch 45/100
400/400 - 511s - loss: 0.0128 - dice_multi: 0.9591
Epoch 46/100
400/400 - 511s - loss: 0.0121 - dice_multi: 0.9606
Epoch 47/100
400/400 - 511s - loss: 0.0123 - dice_multi: 0.9606
Epoch 48/100
400/400 - 511s - loss: 0.0124 - dice_multi: 0.9598
Epoch 49/100
400/400 - 511s - loss: 0.0121 - dice_multi: 0.9623
Epoch 50/100
400/400 - 511s - loss: 0.0123 - dice_multi: 0.9602
Epoch 51/100
400/400 - 511s - loss: 0.0126 - dice_multi: 0.9586
Epoch 52/100
400/400 - 511s - loss: 0.0120 - dice_multi: 0.9613
Epoch 53/100
400/400 - 511s - loss: 0.0115 - dice_multi: 0.9620
Epoch 54/100
400/400 - 511s - loss: 0.0186 - dice_multi: 0.9496
Epoch 55/100
400/400 - 511s - loss: 0.0155 - dice_multi: 0.9523
Epoch 56/100
400/400 - 511s - loss: 0.0134 - dice_multi: 0.9577
Epoch 57/100
400/400 - 511s - loss: 0.0129 - dice_multi: 0.9605
Epoch 58/100
400/400 - 511s - loss: 0.0123 - dice_multi: 0.9616
Epoch 59/100
400/400 - 511s - loss: 0.0113 - dice_multi: 0.9619
Epoch 60/100
400/400 - 511s - loss: 0.0117 - dice_multi: 0.9626
Epoch 61/100
400/400 - 511s - loss: 0.0118 - dice_multi: 0.9629
Epoch 62/100
400/400 - 511s - loss: 0.0115 - dice_multi: 0.9629
Epoch 63/100
400/400 - 511s - loss: 0.0131 - dice_multi: 0.9595
Epoch 64/100
400/400 - 511s - loss: 0.0200 - dice_multi: 0.9478
Epoch 65/100
400/400 - 511s - loss: 0.0121 - dice_multi: 0.9613
Epoch 66/100
400/400 - 511s - loss: 0.0117 - dice_multi: 0.9617
Epoch 67/100
400/400 - 511s - loss: 0.0117 - dice_multi: 0.9631
Epoch 68/100
400/400 - 511s - loss: 0.0116 - dice_multi: 0.9631
Epoch 69/100
400/400 - 511s - loss: 0.0115 - dice_multi: 0.9641
Epoch 70/100
400/400 - 511s - loss: 0.0115 - dice_multi: 0.9643
Epoch 71/100
400/400 - 511s - loss: 0.0116 - dice_multi: 0.9639
Epoch 72/100
400/400 - 511s - loss: 0.0126 - dice_multi: 0.9607
Epoch 73/100
400/400 - 511s - loss: 0.0111 - dice_multi: 0.9640
Epoch 74/100
400/400 - 511s - loss: 0.0112 - dice_multi: 0.9644
Epoch 75/100
400/400 - 511s - loss: 0.0112 - dice_multi: 0.9638
Epoch 76/100
400/400 - 511s - loss: 0.0110 - dice_multi: 0.9636
Epoch 77/100
400/400 - 511s - loss: 0.0124 - dice_multi: 0.9614
Epoch 78/100
400/400 - 511s - loss: 0.0119 - dice_multi: 0.9636
Epoch 79/100
400/400 - 511s - loss: 0.0111 - dice_multi: 0.9641
Epoch 80/100
400/400 - 511s - loss: 0.0114 - dice_multi: 0.9649
Epoch 81/100
400/400 - 511s - loss: 0.0108 - dice_multi: 0.9662
Epoch 82/100
400/400 - 511s - loss: 0.0108 - dice_multi: 0.9662
Epoch 83/100
400/400 - 511s - loss: 0.0108 - dice_multi: 0.9655
Epoch 84/100
400/400 - 511s - loss: 0.0107 - dice_multi: 0.9655
Epoch 85/100
400/400 - 511s - loss: 0.0105 - dice_multi: 0.9668
Epoch 86/100
400/400 - 511s - loss: 0.0106 - dice_multi: 0.9663
Epoch 87/100
400/400 - 511s - loss: 0.0107 - dice_multi: 0.9667
Epoch 88/100
400/400 - 511s - loss: 0.0161 - dice_multi: 0.9523
Epoch 89/100
400/400 - 511s - loss: 0.0138 - dice_multi: 0.9586
Epoch 90/100
400/400 - 511s - loss: 0.0111 - dice_multi: 0.9641
Epoch 91/100
400/400 - 511s - loss: 0.0110 - dice_multi: 0.9647
Epoch 92/100
400/400 - 511s - loss: 0.0108 - dice_multi: 0.9656
Epoch 93/100
400/400 - 511s - loss: 0.0104 - dice_multi: 0.9656
Epoch 94/100
400/400 - 511s - loss: 0.0113 - dice_multi: 0.9639
Epoch 95/100
400/400 - 511s - loss: 0.0106 - dice_multi: 0.9648
Epoch 96/100
400/400 - 511s - loss: 0.0104 - dice_multi: 0.9667
Epoch 97/100
400/400 - 511s - loss: 0.0102 - dice_multi: 0.9670
Epoch 98/100
400/400 - 511s - loss: 0.0105 - dice_multi: 0.9679
Epoch 99/100
400/400 - 511s - loss: 0.0104 - dice_multi: 0.9666
Epoch 100/100
400/400 - 511s - loss: 0.0100 - dice_multi: 0.9682
training time: 51108.499398469925
executation time:138.10928311131218
[0.999232  0.9440766]
