Bayesian U-Net
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2022-01-06 12:32:11.168551: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(63, 117, 159, 126)
2022-01-06 12:32:17.249073: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2022-01-06 12:32:17.283042: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-06 12:32:17.283802: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-06 12:32:17.283833: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2022-01-06 12:32:17.289229: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2022-01-06 12:32:17.289291: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2022-01-06 12:32:17.292245: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2022-01-06 12:32:17.292861: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2022-01-06 12:32:17.293712: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2022-01-06 12:32:17.294874: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2022-01-06 12:32:17.295315: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2022-01-06 12:32:17.298148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-06 12:32:17.489424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-06 12:32:17.490163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-06 12:32:17.492887: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-06 12:32:17.492934: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2022-01-06 12:32:18.216220: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-06 12:32:18.216278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-06 12:32:18.216294: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-06 12:32:18.216303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-06 12:32:18.220367: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-06 12:32:18.221430: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2022-01-06 12:32:18.887822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-06 12:32:18.888609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-06 12:32:18.890703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-06 12:32:18.890747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-06 12:32:18.890759: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-06 12:32:18.890768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-06 12:32:18.890776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-06 12:32:18.892216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-06 12:32:18.892966: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
---------fold--1---------
training set:  [12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35
 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [ 0  1  2  3  4  5  6  7  8  9 10 11]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
2022-01-06 12:32:20.158305: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-06 12:32:20.158886: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2400075000 Hz
2022-01-06 12:32:24.037700: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2022-01-06 12:32:24.451166: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2022-01-06 12:32:24.948667: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2022-01-06 12:32:25.206760: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 553s - loss: 0.1148 - dice_multi: 0.7052
Epoch 2/100
400/400 - 510s - loss: 0.0820 - dice_multi: 0.7780
Epoch 3/100
400/400 - 510s - loss: 0.0683 - dice_multi: 0.8176
Epoch 4/100
400/400 - 510s - loss: 0.0564 - dice_multi: 0.8462
Epoch 5/100
400/400 - 510s - loss: 0.0569 - dice_multi: 0.8558
Epoch 6/100
400/400 - 510s - loss: 0.0374 - dice_multi: 0.8973
Epoch 7/100
400/400 - 510s - loss: 0.0317 - dice_multi: 0.9126
Epoch 8/100
400/400 - 510s - loss: 0.0333 - dice_multi: 0.9084
Epoch 9/100
400/400 - 510s - loss: 0.0226 - dice_multi: 0.9327
Epoch 10/100
400/400 - 510s - loss: 0.0275 - dice_multi: 0.9245
Epoch 11/100
400/400 - 510s - loss: 0.0304 - dice_multi: 0.9199
Epoch 12/100
400/400 - 510s - loss: 0.0197 - dice_multi: 0.9423
Epoch 13/100
400/400 - 510s - loss: 0.0168 - dice_multi: 0.9477
Epoch 14/100
400/400 - 510s - loss: 0.0164 - dice_multi: 0.9508
Epoch 15/100
400/400 - 510s - loss: 0.0167 - dice_multi: 0.9517
Epoch 16/100
400/400 - 510s - loss: 0.0230 - dice_multi: 0.9352
Epoch 17/100
400/400 - 510s - loss: 0.0179 - dice_multi: 0.9473
Epoch 18/100
400/400 - 510s - loss: 0.0179 - dice_multi: 0.9450
Epoch 19/100
400/400 - 510s - loss: 0.0186 - dice_multi: 0.9469
Epoch 20/100
400/400 - 510s - loss: 0.0146 - dice_multi: 0.9544
Epoch 21/100
400/400 - 510s - loss: 0.0145 - dice_multi: 0.9553
Epoch 22/100
400/400 - 510s - loss: 0.0143 - dice_multi: 0.9562
Epoch 23/100
400/400 - 510s - loss: 0.0172 - dice_multi: 0.9497
Epoch 24/100
400/400 - 510s - loss: 0.0145 - dice_multi: 0.9569
Epoch 25/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9580
Epoch 26/100
400/400 - 510s - loss: 0.0211 - dice_multi: 0.9417
Epoch 27/100
400/400 - 510s - loss: 0.0163 - dice_multi: 0.9508
Epoch 28/100
400/400 - 510s - loss: 0.0142 - dice_multi: 0.9573
Epoch 29/100
400/400 - 510s - loss: 0.0138 - dice_multi: 0.9559
Epoch 30/100
400/400 - 510s - loss: 0.0139 - dice_multi: 0.9572
Epoch 31/100
400/400 - 510s - loss: 0.0165 - dice_multi: 0.9543
Epoch 32/100
400/400 - 510s - loss: 0.0142 - dice_multi: 0.9593
Epoch 33/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9601
Epoch 34/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9603
Epoch 35/100
400/400 - 510s - loss: 0.0139 - dice_multi: 0.9595
Epoch 36/100
400/400 - 510s - loss: 0.0132 - dice_multi: 0.9600
Epoch 37/100
400/400 - 510s - loss: 0.0203 - dice_multi: 0.9442
Epoch 38/100
400/400 - 510s - loss: 0.0183 - dice_multi: 0.9476
Epoch 39/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9591
Epoch 40/100
400/400 - 510s - loss: 0.0134 - dice_multi: 0.9599
Epoch 41/100
400/400 - 510s - loss: 0.0128 - dice_multi: 0.9604
Epoch 42/100
400/400 - 510s - loss: 0.0178 - dice_multi: 0.9497
Epoch 43/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9584
Epoch 44/100
400/400 - 510s - loss: 0.0132 - dice_multi: 0.9604
Epoch 45/100
400/400 - 510s - loss: 0.0131 - dice_multi: 0.9605
Epoch 46/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9606
Epoch 47/100
400/400 - 510s - loss: 0.0127 - dice_multi: 0.9614
Epoch 48/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9618
Epoch 49/100
400/400 - 510s - loss: 0.0150 - dice_multi: 0.9555
Epoch 50/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9611
Epoch 51/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9623
Epoch 52/100
400/400 - 510s - loss: 0.0195 - dice_multi: 0.9494
Epoch 53/100
400/400 - 510s - loss: 0.0127 - dice_multi: 0.9601
Epoch 54/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9622
Epoch 55/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9628
Epoch 56/100
400/400 - 510s - loss: 0.0122 - dice_multi: 0.9621
Epoch 57/100
400/400 - 510s - loss: 0.0122 - dice_multi: 0.9630
Epoch 58/100
400/400 - 510s - loss: 0.0121 - dice_multi: 0.9631
Epoch 59/100
400/400 - 510s - loss: 0.0197 - dice_multi: 0.9478
Epoch 60/100
400/400 - 510s - loss: 0.0127 - dice_multi: 0.9608
Epoch 61/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9625
Epoch 62/100
400/400 - 510s - loss: 0.0119 - dice_multi: 0.9626
Epoch 63/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9634
Epoch 64/100
400/400 - 510s - loss: 0.0121 - dice_multi: 0.9643
Epoch 65/100
400/400 - 510s - loss: 0.0119 - dice_multi: 0.9648
Epoch 66/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9632
Epoch 67/100
400/400 - 510s - loss: 0.0139 - dice_multi: 0.9591
Epoch 68/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9632
Epoch 69/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9637
Epoch 70/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9650
Epoch 71/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9649
Epoch 72/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9640
Epoch 73/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9639
Epoch 74/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9657
Epoch 75/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9656
Epoch 76/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9654
Epoch 77/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9652
Epoch 78/100
400/400 - 510s - loss: 0.0157 - dice_multi: 0.9562
Epoch 79/100
400/400 - 510s - loss: 0.0131 - dice_multi: 0.9618
Epoch 80/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9649
Epoch 81/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9661
Epoch 82/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9667
Epoch 83/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9660
Epoch 84/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9674
Epoch 85/100
400/400 - 511s - loss: 0.0108 - dice_multi: 0.9673
Epoch 86/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9674
Epoch 87/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9672
Epoch 88/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9677
Epoch 89/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9680
Epoch 90/100
400/400 - 510s - loss: 0.0129 - dice_multi: 0.9622
Epoch 91/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9668
Epoch 92/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9673
Epoch 93/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9673
Epoch 94/100
400/400 - 510s - loss: 0.0146 - dice_multi: 0.9596
Epoch 95/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9656
Epoch 96/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9667
Epoch 97/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9685
Epoch 98/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9678
Epoch 99/100
400/400 - 510s - loss: 0.0104 - dice_multi: 0.9677
Epoch 100/100
400/400 - 510s - loss: 0.0103 - dice_multi: 0.9685
2022-01-07 03:11:07.513374: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-07 03:11:07.519692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-07 03:11:07.521716: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-07 03:11:07.521766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-07 03:11:07.521778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-07 03:11:07.521787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-07 03:11:07.521795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-07 03:11:07.523259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-07 03:11:07.523990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 51059.226967573166
executation time:138.528686106205
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 24 25 26 27 28 29 30 31 32 33 34 35
 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [12 13 14 15 16 17 18 19 20 21 22 23]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 514s - loss: 0.1392 - dice_multi: 0.6836
Epoch 2/100
400/400 - 510s - loss: 0.0861 - dice_multi: 0.7825
Epoch 3/100
400/400 - 510s - loss: 0.0640 - dice_multi: 0.8366
Epoch 4/100
400/400 - 510s - loss: 0.0535 - dice_multi: 0.8632
Epoch 5/100
400/400 - 510s - loss: 0.0355 - dice_multi: 0.9008
Epoch 6/100
400/400 - 510s - loss: 0.0268 - dice_multi: 0.9251
Epoch 7/100
400/400 - 510s - loss: 0.0350 - dice_multi: 0.9094
Epoch 8/100
400/400 - 511s - loss: 0.0197 - dice_multi: 0.9430
Epoch 9/100
400/400 - 510s - loss: 0.0186 - dice_multi: 0.9450
Epoch 10/100
400/400 - 510s - loss: 0.0173 - dice_multi: 0.9482
Epoch 11/100
400/400 - 510s - loss: 0.0211 - dice_multi: 0.9379
Epoch 12/100
400/400 - 511s - loss: 0.0202 - dice_multi: 0.9421
Epoch 13/100
400/400 - 511s - loss: 0.0350 - dice_multi: 0.9122
Epoch 14/100
400/400 - 511s - loss: 0.0240 - dice_multi: 0.9326
Epoch 15/100
400/400 - 510s - loss: 0.0185 - dice_multi: 0.9490
Epoch 16/100
400/400 - 510s - loss: 0.0167 - dice_multi: 0.9506
Epoch 17/100
400/400 - 510s - loss: 0.0163 - dice_multi: 0.9531
Epoch 18/100
400/400 - 510s - loss: 0.0161 - dice_multi: 0.9536
Epoch 19/100
400/400 - 510s - loss: 0.0151 - dice_multi: 0.9539
Epoch 20/100
400/400 - 510s - loss: 0.0259 - dice_multi: 0.9278
Epoch 21/100
400/400 - 511s - loss: 0.0213 - dice_multi: 0.9444
Epoch 22/100
400/400 - 510s - loss: 0.0158 - dice_multi: 0.9543
Epoch 23/100
400/400 - 510s - loss: 0.0170 - dice_multi: 0.9520
Epoch 24/100
400/400 - 510s - loss: 0.0236 - dice_multi: 0.9369
Epoch 25/100
400/400 - 510s - loss: 0.0156 - dice_multi: 0.9532
Epoch 26/100
400/400 - 510s - loss: 0.0154 - dice_multi: 0.9564
Epoch 27/100
400/400 - 510s - loss: 0.0144 - dice_multi: 0.9570
Epoch 28/100
400/400 - 510s - loss: 0.0154 - dice_multi: 0.9567
Epoch 29/100
400/400 - 510s - loss: 0.0139 - dice_multi: 0.9575
Epoch 30/100
400/400 - 510s - loss: 0.0147 - dice_multi: 0.9579
Epoch 31/100
400/400 - 510s - loss: 0.0263 - dice_multi: 0.9348
Epoch 32/100
400/400 - 510s - loss: 0.0152 - dice_multi: 0.9539
Epoch 33/100
400/400 - 510s - loss: 0.0205 - dice_multi: 0.9450
Epoch 34/100
400/400 - 510s - loss: 0.0151 - dice_multi: 0.9571
Epoch 35/100
400/400 - 510s - loss: 0.0147 - dice_multi: 0.9571
Epoch 36/100
400/400 - 510s - loss: 0.0143 - dice_multi: 0.9588
Epoch 37/100
400/400 - 510s - loss: 0.0145 - dice_multi: 0.9602
Epoch 38/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9592
Epoch 39/100
400/400 - 510s - loss: 0.0144 - dice_multi: 0.9603
Epoch 40/100
400/400 - 510s - loss: 0.0134 - dice_multi: 0.9598
Epoch 41/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9604
Epoch 42/100
400/400 - 510s - loss: 0.0162 - dice_multi: 0.9524
Epoch 43/100
400/400 - 510s - loss: 0.0154 - dice_multi: 0.9554
Epoch 44/100
400/400 - 510s - loss: 0.0138 - dice_multi: 0.9598
Epoch 45/100
400/400 - 510s - loss: 0.0134 - dice_multi: 0.9611
Epoch 46/100
400/400 - 510s - loss: 0.0236 - dice_multi: 0.9398
Epoch 47/100
400/400 - 510s - loss: 0.0147 - dice_multi: 0.9566
Epoch 48/100
400/400 - 510s - loss: 0.0140 - dice_multi: 0.9593
Epoch 49/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9601
Epoch 50/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9604
Epoch 51/100
400/400 - 511s - loss: 0.0135 - dice_multi: 0.9608
Epoch 52/100
400/400 - 510s - loss: 0.0130 - dice_multi: 0.9614
Epoch 53/100
400/400 - 510s - loss: 0.0132 - dice_multi: 0.9616
Epoch 54/100
400/400 - 510s - loss: 0.0129 - dice_multi: 0.9623
Epoch 55/100
400/400 - 510s - loss: 0.0130 - dice_multi: 0.9626
Epoch 56/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9626
Epoch 57/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9628
Epoch 58/100
400/400 - 510s - loss: 0.0135 - dice_multi: 0.9620
Epoch 59/100
400/400 - 510s - loss: 0.0129 - dice_multi: 0.9627
Epoch 60/100
400/400 - 511s - loss: 0.0118 - dice_multi: 0.9637
Epoch 61/100
400/400 - 511s - loss: 0.0120 - dice_multi: 0.9643
Epoch 62/100
400/400 - 511s - loss: 0.0119 - dice_multi: 0.9646
Epoch 63/100
400/400 - 511s - loss: 0.0121 - dice_multi: 0.9653
Epoch 64/100
400/400 - 511s - loss: 0.0184 - dice_multi: 0.9510
Epoch 65/100
400/400 - 511s - loss: 0.0144 - dice_multi: 0.9592
Epoch 66/100
400/400 - 511s - loss: 0.0124 - dice_multi: 0.9630
Epoch 67/100
400/400 - 511s - loss: 0.0123 - dice_multi: 0.9636
Epoch 68/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9636
Epoch 69/100
400/400 - 510s - loss: 0.0119 - dice_multi: 0.9648
Epoch 70/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9657
Epoch 71/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9664
Epoch 72/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9659
Epoch 73/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9668
Epoch 74/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9661
Epoch 75/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9655
Epoch 76/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9674
Epoch 77/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9671
Epoch 78/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9671
Epoch 79/100
400/400 - 510s - loss: 0.0225 - dice_multi: 0.9473
Epoch 80/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9605
Epoch 81/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9630
Epoch 82/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9655
Epoch 83/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9663
Epoch 84/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9668
Epoch 85/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9674
Epoch 86/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9679
Epoch 87/100
400/400 - 510s - loss: 0.0143 - dice_multi: 0.9600
Epoch 88/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9658
Epoch 89/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9664
Epoch 90/100
400/400 - 511s - loss: 0.0111 - dice_multi: 0.9676
Epoch 91/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9682
Epoch 92/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9684
Epoch 93/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9681
Epoch 94/100
400/400 - 510s - loss: 0.0187 - dice_multi: 0.9502
Epoch 95/100
400/400 - 510s - loss: 0.0119 - dice_multi: 0.9640
Epoch 96/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9661
Epoch 97/100
400/400 - 511s - loss: 0.0113 - dice_multi: 0.9666
Epoch 98/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9674
Epoch 99/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9677
Epoch 100/100
400/400 - 511s - loss: 0.0109 - dice_multi: 0.9684
2022-01-07 17:49:38.311873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-07 17:49:38.318431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-07 17:49:38.320438: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-07 17:49:38.320515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-07 17:49:38.320528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-07 17:49:38.320537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-07 17:49:38.320544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-07 17:49:38.321992: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-07 17:49:38.322719: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 51036.248817682266
executation time:138.9044515490532
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [24 25 26 27 28 29 30 31 32 33 34 35]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 514s - loss: 0.1134 - dice_multi: 0.7170
Epoch 2/100
400/400 - 511s - loss: 0.0720 - dice_multi: 0.8076
Epoch 3/100
400/400 - 511s - loss: 0.0586 - dice_multi: 0.8442
Epoch 4/100
400/400 - 511s - loss: 0.0463 - dice_multi: 0.8781
Epoch 5/100
400/400 - 511s - loss: 0.0409 - dice_multi: 0.8926
Epoch 6/100
400/400 - 510s - loss: 0.0359 - dice_multi: 0.9047
Epoch 7/100
400/400 - 510s - loss: 0.0300 - dice_multi: 0.9237
Epoch 8/100
400/400 - 510s - loss: 0.0203 - dice_multi: 0.9409
Epoch 9/100
400/400 - 511s - loss: 0.0184 - dice_multi: 0.9473
Epoch 10/100
400/400 - 511s - loss: 0.0341 - dice_multi: 0.9263
Epoch 11/100
400/400 - 511s - loss: 0.0295 - dice_multi: 0.9220
Epoch 12/100
400/400 - 510s - loss: 0.0186 - dice_multi: 0.9442
Epoch 13/100
400/400 - 510s - loss: 0.0179 - dice_multi: 0.9506
Epoch 14/100
400/400 - 510s - loss: 0.0175 - dice_multi: 0.9502
Epoch 15/100
400/400 - 510s - loss: 0.0155 - dice_multi: 0.9526
Epoch 16/100
400/400 - 510s - loss: 0.0151 - dice_multi: 0.9541
Epoch 17/100
400/400 - 511s - loss: 0.0233 - dice_multi: 0.9355
Epoch 18/100
400/400 - 511s - loss: 0.0251 - dice_multi: 0.9388
Epoch 19/100
400/400 - 511s - loss: 0.0159 - dice_multi: 0.9536
Epoch 20/100
400/400 - 510s - loss: 0.0150 - dice_multi: 0.9552
Epoch 21/100
400/400 - 510s - loss: 0.0164 - dice_multi: 0.9530
Epoch 22/100
400/400 - 510s - loss: 0.0170 - dice_multi: 0.9489
Epoch 23/100
400/400 - 510s - loss: 0.0146 - dice_multi: 0.9575
Epoch 24/100
400/400 - 510s - loss: 0.0143 - dice_multi: 0.9581
Epoch 25/100
400/400 - 510s - loss: 0.0138 - dice_multi: 0.9587
Epoch 26/100
400/400 - 510s - loss: 0.0208 - dice_multi: 0.9455
Epoch 27/100
400/400 - 510s - loss: 0.0301 - dice_multi: 0.9270
Epoch 28/100
400/400 - 510s - loss: 0.0196 - dice_multi: 0.9431
Epoch 29/100
400/400 - 510s - loss: 0.0153 - dice_multi: 0.9551
Epoch 30/100
400/400 - 511s - loss: 0.0144 - dice_multi: 0.9573
Epoch 31/100
400/400 - 511s - loss: 0.0143 - dice_multi: 0.9587
Epoch 32/100
400/400 - 511s - loss: 0.0137 - dice_multi: 0.9590
Epoch 33/100
400/400 - 510s - loss: 0.0134 - dice_multi: 0.9606
Epoch 34/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9590
Epoch 35/100
400/400 - 511s - loss: 0.0144 - dice_multi: 0.9583
Epoch 36/100
400/400 - 511s - loss: 0.0134 - dice_multi: 0.9614
Epoch 37/100
400/400 - 511s - loss: 0.0131 - dice_multi: 0.9610
Epoch 38/100
400/400 - 511s - loss: 0.0176 - dice_multi: 0.9527
Epoch 39/100
400/400 - 511s - loss: 0.0154 - dice_multi: 0.9564
Epoch 40/100
400/400 - 511s - loss: 0.0129 - dice_multi: 0.9593
Epoch 41/100
400/400 - 511s - loss: 0.0132 - dice_multi: 0.9621
Epoch 42/100
400/400 - 511s - loss: 0.0127 - dice_multi: 0.9630
Epoch 43/100
400/400 - 511s - loss: 0.0124 - dice_multi: 0.9627
Epoch 44/100
400/400 - 510s - loss: 0.0128 - dice_multi: 0.9632
Epoch 45/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9630
Epoch 46/100
400/400 - 510s - loss: 0.0122 - dice_multi: 0.9628
Epoch 47/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9645
Epoch 48/100
400/400 - 510s - loss: 0.0158 - dice_multi: 0.9557
Epoch 49/100
400/400 - 510s - loss: 0.0136 - dice_multi: 0.9584
Epoch 50/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9623
Epoch 51/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9648
Epoch 52/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9651
Epoch 53/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9647
Epoch 54/100
400/400 - 510s - loss: 0.0117 - dice_multi: 0.9654
Epoch 55/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9663
Epoch 56/100
400/400 - 510s - loss: 0.0129 - dice_multi: 0.9626
Epoch 57/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9633
Epoch 58/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9660
Epoch 59/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9668
Epoch 60/100
400/400 - 510s - loss: 0.0122 - dice_multi: 0.9635
Epoch 61/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9660
Epoch 62/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9669
Epoch 63/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9662
Epoch 64/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9663
Epoch 65/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9672
Epoch 66/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9664
Epoch 67/100
400/400 - 510s - loss: 0.0141 - dice_multi: 0.9576
Epoch 68/100
400/400 - 510s - loss: 0.0135 - dice_multi: 0.9616
Epoch 69/100
400/400 - 510s - loss: 0.0131 - dice_multi: 0.9631
Epoch 70/100
400/400 - 510s - loss: 0.0120 - dice_multi: 0.9658
Epoch 71/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9667
Epoch 72/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9674
Epoch 73/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9683
Epoch 74/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9688
Epoch 75/100
400/400 - 510s - loss: 0.0103 - dice_multi: 0.9690
Epoch 76/100
400/400 - 510s - loss: 0.0104 - dice_multi: 0.9690
Epoch 77/100
400/400 - 511s - loss: 0.0104 - dice_multi: 0.9691
Epoch 78/100
400/400 - 511s - loss: 0.0183 - dice_multi: 0.9537
Epoch 79/100
400/400 - 511s - loss: 0.0121 - dice_multi: 0.9639
Epoch 80/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9661
Epoch 81/100
400/400 - 511s - loss: 0.0109 - dice_multi: 0.9680
Epoch 82/100
400/400 - 511s - loss: 0.0107 - dice_multi: 0.9680
Epoch 83/100
400/400 - 511s - loss: 0.0106 - dice_multi: 0.9696
Epoch 84/100
400/400 - 511s - loss: 0.0105 - dice_multi: 0.9700
Epoch 85/100
400/400 - 511s - loss: 0.0104 - dice_multi: 0.9693
Epoch 86/100
400/400 - 511s - loss: 0.0101 - dice_multi: 0.9701
Epoch 87/100
400/400 - 511s - loss: 0.0101 - dice_multi: 0.9694
Epoch 88/100
400/400 - 511s - loss: 0.0103 - dice_multi: 0.9697
Epoch 89/100
400/400 - 511s - loss: 0.0099 - dice_multi: 0.9695
Epoch 90/100
400/400 - 511s - loss: 0.0103 - dice_multi: 0.9703
Epoch 91/100
400/400 - 511s - loss: 0.0099 - dice_multi: 0.9705
Epoch 92/100
400/400 - 511s - loss: 0.0196 - dice_multi: 0.9543
Epoch 93/100
400/400 - 511s - loss: 0.0120 - dice_multi: 0.9648
Epoch 94/100
400/400 - 511s - loss: 0.0110 - dice_multi: 0.9679
Epoch 95/100
400/400 - 511s - loss: 0.0105 - dice_multi: 0.9693
Epoch 96/100
400/400 - 511s - loss: 0.0102 - dice_multi: 0.9698
Epoch 97/100
400/400 - 511s - loss: 0.0099 - dice_multi: 0.9696
Epoch 98/100
400/400 - 511s - loss: 0.0101 - dice_multi: 0.9700
Epoch 99/100
400/400 - 511s - loss: 0.0101 - dice_multi: 0.9710
Epoch 100/100
400/400 - 511s - loss: 0.0099 - dice_multi: 0.9704
2022-01-08 08:28:28.120026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-08 08:28:28.121191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-08 08:28:28.123174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-08 08:28:28.123234: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-08 08:28:28.123246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-08 08:28:28.123255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-08 08:28:28.123263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-08 08:28:28.124644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-08 08:28:28.125356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 51055.454033613205
executation time:138.8659103512764
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [36 37 38 39 40 41 42 43 44 45 46 47]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 514s - loss: 0.0978 - dice_multi: 0.7279
Epoch 2/100
400/400 - 511s - loss: 0.0461 - dice_multi: 0.8473
Epoch 3/100
400/400 - 510s - loss: 0.0389 - dice_multi: 0.8779
Epoch 4/100
400/400 - 510s - loss: 0.0248 - dice_multi: 0.9182
Epoch 5/100
400/400 - 510s - loss: 0.0225 - dice_multi: 0.9245
Epoch 6/100
400/400 - 510s - loss: 0.0190 - dice_multi: 0.9363
Epoch 7/100
400/400 - 510s - loss: 0.0188 - dice_multi: 0.9379
Epoch 8/100
400/400 - 510s - loss: 0.0166 - dice_multi: 0.9432
Epoch 9/100
400/400 - 510s - loss: 0.0160 - dice_multi: 0.9453
Epoch 10/100
400/400 - 510s - loss: 0.0223 - dice_multi: 0.9302
Epoch 11/100
400/400 - 510s - loss: 0.0166 - dice_multi: 0.9451
Epoch 12/100
400/400 - 510s - loss: 0.0154 - dice_multi: 0.9478
Epoch 13/100
400/400 - 510s - loss: 0.0152 - dice_multi: 0.9512
Epoch 14/100
400/400 - 511s - loss: 0.0154 - dice_multi: 0.9491
Epoch 15/100
400/400 - 510s - loss: 0.0141 - dice_multi: 0.9531
Epoch 16/100
400/400 - 510s - loss: 0.0154 - dice_multi: 0.9491
Epoch 17/100
400/400 - 511s - loss: 0.0132 - dice_multi: 0.9553
Epoch 18/100
400/400 - 511s - loss: 0.0134 - dice_multi: 0.9577
Epoch 19/100
400/400 - 510s - loss: 0.0125 - dice_multi: 0.9577
Epoch 20/100
400/400 - 510s - loss: 0.0192 - dice_multi: 0.9373
Epoch 21/100
400/400 - 510s - loss: 0.0153 - dice_multi: 0.9498
Epoch 22/100
400/400 - 510s - loss: 0.0130 - dice_multi: 0.9567
Epoch 23/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9582
Epoch 24/100
400/400 - 510s - loss: 0.0127 - dice_multi: 0.9570
Epoch 25/100
400/400 - 510s - loss: 0.0123 - dice_multi: 0.9584
Epoch 26/100
400/400 - 510s - loss: 0.0130 - dice_multi: 0.9554
Epoch 27/100
400/400 - 510s - loss: 0.0121 - dice_multi: 0.9596
Epoch 28/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9601
Epoch 29/100
400/400 - 510s - loss: 0.0121 - dice_multi: 0.9607
Epoch 30/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9612
Epoch 31/100
400/400 - 510s - loss: 0.0118 - dice_multi: 0.9605
Epoch 32/100
400/400 - 510s - loss: 0.0152 - dice_multi: 0.9524
Epoch 33/100
400/400 - 510s - loss: 0.0124 - dice_multi: 0.9581
Epoch 34/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9616
Epoch 35/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9622
Epoch 36/100
400/400 - 510s - loss: 0.0107 - dice_multi: 0.9634
Epoch 37/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9640
Epoch 38/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9632
Epoch 39/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9635
Epoch 40/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9635
Epoch 41/100
400/400 - 510s - loss: 0.0104 - dice_multi: 0.9651
Epoch 42/100
400/400 - 510s - loss: 0.0103 - dice_multi: 0.9653
Epoch 43/100
400/400 - 511s - loss: 0.0100 - dice_multi: 0.9659
Epoch 44/100
400/400 - 511s - loss: 0.0108 - dice_multi: 0.9640
Epoch 45/100
400/400 - 510s - loss: 0.0100 - dice_multi: 0.9666
Epoch 46/100
400/400 - 510s - loss: 0.0096 - dice_multi: 0.9665
Epoch 47/100
400/400 - 510s - loss: 0.0096 - dice_multi: 0.9674
Epoch 48/100
400/400 - 510s - loss: 0.0100 - dice_multi: 0.9670
Epoch 49/100
400/400 - 510s - loss: 0.0098 - dice_multi: 0.9670
Epoch 50/100
400/400 - 510s - loss: 0.0147 - dice_multi: 0.9521
Epoch 51/100
400/400 - 510s - loss: 0.0105 - dice_multi: 0.9649
Epoch 52/100
400/400 - 510s - loss: 0.0101 - dice_multi: 0.9656
Epoch 53/100
400/400 - 510s - loss: 0.0095 - dice_multi: 0.9669
Epoch 54/100
400/400 - 510s - loss: 0.0094 - dice_multi: 0.9683
Epoch 55/100
400/400 - 510s - loss: 0.0092 - dice_multi: 0.9686
Epoch 56/100
400/400 - 510s - loss: 0.0093 - dice_multi: 0.9685
Epoch 57/100
400/400 - 510s - loss: 0.0094 - dice_multi: 0.9691
Epoch 58/100
400/400 - 510s - loss: 0.0092 - dice_multi: 0.9686
Epoch 59/100
400/400 - 510s - loss: 0.0094 - dice_multi: 0.9700
Epoch 60/100
400/400 - 511s - loss: 0.0093 - dice_multi: 0.9694
Epoch 61/100
400/400 - 510s - loss: 0.0095 - dice_multi: 0.9684
Epoch 62/100
400/400 - 510s - loss: 0.0087 - dice_multi: 0.9701
Epoch 63/100
400/400 - 510s - loss: 0.0102 - dice_multi: 0.9655
Epoch 64/100
400/400 - 510s - loss: 0.0091 - dice_multi: 0.9696
Epoch 65/100
400/400 - 511s - loss: 0.0090 - dice_multi: 0.9695
Epoch 66/100
400/400 - 510s - loss: 0.0085 - dice_multi: 0.9705
Epoch 67/100
400/400 - 510s - loss: 0.0085 - dice_multi: 0.9700
Epoch 68/100
400/400 - 510s - loss: 0.0095 - dice_multi: 0.9686
Epoch 69/100
400/400 - 510s - loss: 0.0089 - dice_multi: 0.9707
Epoch 70/100
400/400 - 510s - loss: 0.0087 - dice_multi: 0.9702
Epoch 71/100
400/400 - 511s - loss: 0.0087 - dice_multi: 0.9711
Epoch 72/100
400/400 - 510s - loss: 0.0086 - dice_multi: 0.9708
Epoch 73/100
400/400 - 510s - loss: 0.0086 - dice_multi: 0.9713
Epoch 74/100
400/400 - 511s - loss: 0.0084 - dice_multi: 0.9707
Epoch 75/100
400/400 - 510s - loss: 0.0088 - dice_multi: 0.9707
Epoch 76/100
400/400 - 511s - loss: 0.0088 - dice_multi: 0.9711
Epoch 77/100
400/400 - 510s - loss: 0.0084 - dice_multi: 0.9714
Epoch 78/100
400/400 - 511s - loss: 0.0085 - dice_multi: 0.9717
Epoch 79/100
400/400 - 511s - loss: 0.0085 - dice_multi: 0.9709
Epoch 80/100
400/400 - 510s - loss: 0.0084 - dice_multi: 0.9721
Epoch 81/100
400/400 - 511s - loss: 0.0084 - dice_multi: 0.9720
Epoch 82/100
400/400 - 511s - loss: 0.0084 - dice_multi: 0.9719
Epoch 83/100
400/400 - 511s - loss: 0.0083 - dice_multi: 0.9717
Epoch 84/100
400/400 - 511s - loss: 0.0082 - dice_multi: 0.9727
Epoch 85/100
400/400 - 510s - loss: 0.0168 - dice_multi: 0.9526
Epoch 86/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9636
Epoch 87/100
400/400 - 510s - loss: 0.0094 - dice_multi: 0.9681
Epoch 88/100
400/400 - 511s - loss: 0.0087 - dice_multi: 0.9708
Epoch 89/100
400/400 - 511s - loss: 0.0086 - dice_multi: 0.9716
Epoch 90/100
400/400 - 510s - loss: 0.0085 - dice_multi: 0.9723
Epoch 91/100
400/400 - 510s - loss: 0.0084 - dice_multi: 0.9716
Epoch 92/100
400/400 - 510s - loss: 0.0085 - dice_multi: 0.9719
Epoch 93/100
400/400 - 511s - loss: 0.0082 - dice_multi: 0.9729
Epoch 94/100
400/400 - 511s - loss: 0.0080 - dice_multi: 0.9724
Epoch 95/100
400/400 - 510s - loss: 0.0082 - dice_multi: 0.9715
Epoch 96/100
400/400 - 511s - loss: 0.0081 - dice_multi: 0.9724
Epoch 97/100
400/400 - 510s - loss: 0.0082 - dice_multi: 0.9727
Epoch 98/100
400/400 - 510s - loss: 0.0082 - dice_multi: 0.9729
Epoch 99/100
400/400 - 511s - loss: 0.0083 - dice_multi: 0.9729
Epoch 100/100
400/400 - 511s - loss: 0.0083 - dice_multi: 0.9716
2022-01-08 23:07:00.014715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-08 23:07:00.042515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-08 23:07:00.044739: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-08 23:07:00.044791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-08 23:07:00.044804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-08 23:07:00.044814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-08 23:07:00.044822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-08 23:07:00.046298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-08 23:07:00.047113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 51047.62806248665
executation time:138.0903313755989
---------fold--5---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47]
training set size:  48
testing set:  [48 49 50 51 52 53 54 55 56 57 58 59 60 61 62]
testing set size:  15
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 514s - loss: 0.1162 - dice_multi: 0.7091
Epoch 2/100
400/400 - 510s - loss: 0.0731 - dice_multi: 0.8119
Epoch 3/100
400/400 - 510s - loss: 0.0667 - dice_multi: 0.8269
Epoch 4/100
400/400 - 511s - loss: 0.0486 - dice_multi: 0.8679
Epoch 5/100
400/400 - 510s - loss: 0.0363 - dice_multi: 0.8966
Epoch 6/100
400/400 - 511s - loss: 0.0390 - dice_multi: 0.8901
Epoch 7/100
400/400 - 511s - loss: 0.0241 - dice_multi: 0.9320
Epoch 8/100
400/400 - 511s - loss: 0.0219 - dice_multi: 0.9351
Epoch 9/100
400/400 - 510s - loss: 0.0283 - dice_multi: 0.9210
Epoch 10/100
400/400 - 511s - loss: 0.0218 - dice_multi: 0.9389
Epoch 11/100
400/400 - 510s - loss: 0.0176 - dice_multi: 0.9471
Epoch 12/100
400/400 - 511s - loss: 0.0172 - dice_multi: 0.9503
Epoch 13/100
400/400 - 510s - loss: 0.0251 - dice_multi: 0.9299
Epoch 14/100
400/400 - 511s - loss: 0.0178 - dice_multi: 0.9452
Epoch 15/100
400/400 - 510s - loss: 0.0171 - dice_multi: 0.9512
Epoch 16/100
400/400 - 511s - loss: 0.0181 - dice_multi: 0.9470
Epoch 17/100
400/400 - 511s - loss: 0.0157 - dice_multi: 0.9525
Epoch 18/100
400/400 - 511s - loss: 0.0211 - dice_multi: 0.9407
Epoch 19/100
400/400 - 510s - loss: 0.0153 - dice_multi: 0.9544
Epoch 20/100
400/400 - 511s - loss: 0.0150 - dice_multi: 0.9560
Epoch 21/100
400/400 - 510s - loss: 0.0146 - dice_multi: 0.9546
Epoch 22/100
400/400 - 510s - loss: 0.0192 - dice_multi: 0.9470
Epoch 23/100
400/400 - 511s - loss: 0.0156 - dice_multi: 0.9525
Epoch 24/100
400/400 - 511s - loss: 0.0144 - dice_multi: 0.9561
Epoch 25/100
400/400 - 511s - loss: 0.0146 - dice_multi: 0.9568
Epoch 26/100
400/400 - 511s - loss: 0.0148 - dice_multi: 0.9560
Epoch 27/100
400/400 - 511s - loss: 0.0242 - dice_multi: 0.9356
Epoch 28/100
400/400 - 510s - loss: 0.0161 - dice_multi: 0.9511
Epoch 29/100
400/400 - 511s - loss: 0.0144 - dice_multi: 0.9554
Epoch 30/100
400/400 - 511s - loss: 0.0143 - dice_multi: 0.9586
Epoch 31/100
400/400 - 511s - loss: 0.0141 - dice_multi: 0.9579
Epoch 32/100
400/400 - 511s - loss: 0.0137 - dice_multi: 0.9589
Epoch 33/100
400/400 - 511s - loss: 0.0139 - dice_multi: 0.9587
Epoch 34/100
400/400 - 511s - loss: 0.0217 - dice_multi: 0.9423
Epoch 35/100
400/400 - 510s - loss: 0.0153 - dice_multi: 0.9552
Epoch 36/100
400/400 - 510s - loss: 0.0148 - dice_multi: 0.9564
Epoch 37/100
400/400 - 510s - loss: 0.0142 - dice_multi: 0.9594
Epoch 38/100
400/400 - 510s - loss: 0.0152 - dice_multi: 0.9568
Epoch 39/100
400/400 - 511s - loss: 0.0138 - dice_multi: 0.9596
Epoch 40/100
400/400 - 511s - loss: 0.0130 - dice_multi: 0.9598
Epoch 41/100
400/400 - 511s - loss: 0.0132 - dice_multi: 0.9614
Epoch 42/100
400/400 - 511s - loss: 0.0129 - dice_multi: 0.9606
Epoch 43/100
400/400 - 511s - loss: 0.0127 - dice_multi: 0.9617
Epoch 44/100
400/400 - 511s - loss: 0.0123 - dice_multi: 0.9615
Epoch 45/100
400/400 - 511s - loss: 0.0125 - dice_multi: 0.9626
Epoch 46/100
400/400 - 510s - loss: 0.0169 - dice_multi: 0.9517
Epoch 47/100
400/400 - 511s - loss: 0.0137 - dice_multi: 0.9580
Epoch 48/100
400/400 - 511s - loss: 0.0127 - dice_multi: 0.9604
Epoch 49/100
400/400 - 511s - loss: 0.0125 - dice_multi: 0.9621
Epoch 50/100
400/400 - 511s - loss: 0.0119 - dice_multi: 0.9633
Epoch 51/100
400/400 - 510s - loss: 0.0121 - dice_multi: 0.9627
Epoch 52/100
400/400 - 511s - loss: 0.0130 - dice_multi: 0.9616
Epoch 53/100
400/400 - 511s - loss: 0.0122 - dice_multi: 0.9625
Epoch 54/100
400/400 - 511s - loss: 0.0119 - dice_multi: 0.9636
Epoch 55/100
400/400 - 511s - loss: 0.0122 - dice_multi: 0.9644
Epoch 56/100
400/400 - 511s - loss: 0.0175 - dice_multi: 0.9533
Epoch 57/100
400/400 - 511s - loss: 0.0132 - dice_multi: 0.9598
Epoch 58/100
400/400 - 511s - loss: 0.0123 - dice_multi: 0.9630
Epoch 59/100
400/400 - 511s - loss: 0.0116 - dice_multi: 0.9636
Epoch 60/100
400/400 - 511s - loss: 0.0121 - dice_multi: 0.9640
Epoch 61/100
400/400 - 510s - loss: 0.0114 - dice_multi: 0.9652
Epoch 62/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9650
Epoch 63/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9653
Epoch 64/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9654
Epoch 65/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9643
Epoch 66/100
400/400 - 511s - loss: 0.0121 - dice_multi: 0.9637
Epoch 67/100
400/400 - 510s - loss: 0.0210 - dice_multi: 0.9486
Epoch 68/100
400/400 - 510s - loss: 0.0126 - dice_multi: 0.9606
Epoch 69/100
400/400 - 511s - loss: 0.0120 - dice_multi: 0.9639
Epoch 70/100
400/400 - 511s - loss: 0.0117 - dice_multi: 0.9648
Epoch 71/100
400/400 - 511s - loss: 0.0114 - dice_multi: 0.9649
Epoch 72/100
400/400 - 511s - loss: 0.0112 - dice_multi: 0.9650
Epoch 73/100
400/400 - 511s - loss: 0.0114 - dice_multi: 0.9653
Epoch 74/100
400/400 - 511s - loss: 0.0111 - dice_multi: 0.9666
Epoch 75/100
400/400 - 511s - loss: 0.0178 - dice_multi: 0.9520
Epoch 76/100
400/400 - 510s - loss: 0.0132 - dice_multi: 0.9601
Epoch 77/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9639
Epoch 78/100
400/400 - 510s - loss: 0.0112 - dice_multi: 0.9659
Epoch 79/100
400/400 - 510s - loss: 0.0113 - dice_multi: 0.9659
Epoch 80/100
400/400 - 510s - loss: 0.0109 - dice_multi: 0.9662
Epoch 81/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9659
Epoch 82/100
400/400 - 510s - loss: 0.0137 - dice_multi: 0.9622
Epoch 83/100
400/400 - 510s - loss: 0.0115 - dice_multi: 0.9651
Epoch 84/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9657
Epoch 85/100
400/400 - 510s - loss: 0.0111 - dice_multi: 0.9675
Epoch 86/100
400/400 - 510s - loss: 0.0108 - dice_multi: 0.9681
Epoch 87/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9677
Epoch 88/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9681
Epoch 89/100
400/400 - 510s - loss: 0.0116 - dice_multi: 0.9648
Epoch 90/100
400/400 - 510s - loss: 0.0189 - dice_multi: 0.9512
Epoch 91/100
400/400 - 510s - loss: 0.0121 - dice_multi: 0.9653
Epoch 92/100
400/400 - 511s - loss: 0.0107 - dice_multi: 0.9665
Epoch 93/100
400/400 - 510s - loss: 0.0110 - dice_multi: 0.9680
Epoch 94/100
400/400 - 510s - loss: 0.0104 - dice_multi: 0.9680
Epoch 95/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9681
Epoch 96/100
400/400 - 510s - loss: 0.0106 - dice_multi: 0.9684
Epoch 97/100
400/400 - 510s - loss: 0.0104 - dice_multi: 0.9687
Epoch 98/100
400/400 - 510s - loss: 0.0101 - dice_multi: 0.9682
Epoch 99/100
400/400 - 510s - loss: 0.0102 - dice_multi: 0.9682
Epoch 100/100
400/400 - 510s - loss: 0.0152 - dice_multi: 0.9568
training time: 51057.13182258606
executation time:138.54882977803547
[0.99835104 0.9355851 ]
