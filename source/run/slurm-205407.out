Bayesian U-Net 3D spatial concrete dropout
[33mWARNING:[0m NVIDIA binaries may not be bound with --writable
2022-01-20 09:34:33.389646: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
..data size:(63, 117, 159, 126)
2022-01-20 09:34:39.800241: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2022-01-20 09:34:39.841903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-20 09:34:39.842662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-20 09:34:39.842694: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2022-01-20 09:34:39.847805: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2022-01-20 09:34:39.847860: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2022-01-20 09:34:39.850797: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2022-01-20 09:34:39.851407: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2022-01-20 09:34:39.852257: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2022-01-20 09:34:39.853463: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2022-01-20 09:34:39.853966: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2022-01-20 09:34:39.856866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-20 09:34:40.048212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-20 09:34:40.048949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-20 09:34:40.051681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-20 09:34:40.051726: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2022-01-20 09:34:40.742630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-20 09:34:40.742685: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-20 09:34:40.742700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-20 09:34:40.742707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-20 09:34:40.746552: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-20 09:34:40.747554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
WARNING:tensorflow:AutoGraph could not transform <bound method Spatial3DConcreteDropout.call of <model.ConcreteDropout.spatialConcreteDropout.Spatial3DConcreteDropout object at 0x2aac95e22eb0>> and will run it as-is.
Cause: code mixing tabs and spaces for indentation is not allowed
To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
---------fold--1---------
training set:  [12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35
 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [ 0  1  2  3  4  5  6  7  8  9 10 11]
testing set size:  12
2022-01-20 09:34:41.539004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-20 09:34:41.539756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-20 09:34:41.541771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-20 09:34:41.541811: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-20 09:34:41.541822: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-20 09:34:41.541830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-20 09:34:41.541837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-20 09:34:41.543204: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-20 09:34:41.543903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
2022-01-20 09:34:42.808160: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:176] None of the MLIR Optimization Passes are enabled (registered 2)
2022-01-20 09:34:42.808715: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 2400085000 Hz
2022-01-20 09:34:49.294532: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2022-01-20 09:34:49.667573: I tensorflow/stream_executor/cuda/cuda_dnn.cc:380] Loaded cuDNN version 8202
2022-01-20 09:34:50.119986: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2022-01-20 09:34:50.385256: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
Epoch 1/100
400/400 - 583s - loss: 0.1239 - dice_multi: 0.6998
Epoch 2/100
400/400 - 534s - loss: 0.0824 - dice_multi: 0.7936
Epoch 3/100
400/400 - 534s - loss: 0.0698 - dice_multi: 0.8235
Epoch 4/100
400/400 - 533s - loss: 0.0564 - dice_multi: 0.8606
Epoch 5/100
400/400 - 533s - loss: 0.0351 - dice_multi: 0.9029
Epoch 6/100
400/400 - 534s - loss: 0.0216 - dice_multi: 0.9276
Epoch 7/100
400/400 - 534s - loss: 0.0335 - dice_multi: 0.9014
Epoch 8/100
400/400 - 534s - loss: 0.0177 - dice_multi: 0.9337
Epoch 9/100
400/400 - 534s - loss: 0.0111 - dice_multi: 0.9414
Epoch 10/100
400/400 - 534s - loss: 0.0242 - dice_multi: 0.9167
Epoch 11/100
400/400 - 533s - loss: 0.0196 - dice_multi: 0.9268
Epoch 12/100
400/400 - 534s - loss: 0.0151 - dice_multi: 0.9348
Epoch 13/100
400/400 - 534s - loss: 0.0234 - dice_multi: 0.9220
Epoch 14/100
400/400 - 534s - loss: 0.0165 - dice_multi: 0.9365
Epoch 15/100
400/400 - 534s - loss: 0.0102 - dice_multi: 0.9448
Epoch 16/100
400/400 - 534s - loss: 0.0081 - dice_multi: 0.9469
Epoch 17/100
400/400 - 534s - loss: 0.0208 - dice_multi: 0.9232
Epoch 18/100
400/400 - 534s - loss: 0.0117 - dice_multi: 0.9423
Epoch 19/100
400/400 - 533s - loss: 0.0072 - dice_multi: 0.9474
Epoch 20/100
400/400 - 533s - loss: 0.0080 - dice_multi: 0.9425
Epoch 21/100
400/400 - 533s - loss: 0.0265 - dice_multi: 0.9224
Epoch 22/100
400/400 - 533s - loss: 0.0209 - dice_multi: 0.9272
Epoch 23/100
400/400 - 533s - loss: 0.0073 - dice_multi: 0.9484
Epoch 24/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9510
Epoch 25/100
400/400 - 534s - loss: 0.0145 - dice_multi: 0.9375
Epoch 26/100
400/400 - 534s - loss: 0.0103 - dice_multi: 0.9445
Epoch 27/100
400/400 - 533s - loss: 0.0073 - dice_multi: 0.9491
Epoch 28/100
400/400 - 533s - loss: 0.0040 - dice_multi: 0.9515
Epoch 29/100
400/400 - 533s - loss: 0.0031 - dice_multi: 0.9513
Epoch 30/100
400/400 - 533s - loss: 0.0107 - dice_multi: 0.9413
Epoch 31/100
400/400 - 534s - loss: 0.0219 - dice_multi: 0.9263
Epoch 32/100
400/400 - 533s - loss: 0.0075 - dice_multi: 0.9499
Epoch 33/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9502
Epoch 34/100
400/400 - 533s - loss: 0.0064 - dice_multi: 0.9490
Epoch 35/100
400/400 - 533s - loss: 0.0168 - dice_multi: 0.9347
Epoch 36/100
400/400 - 533s - loss: 0.0064 - dice_multi: 0.9516
Epoch 37/100
400/400 - 533s - loss: 0.0051 - dice_multi: 0.9514
Epoch 38/100
400/400 - 533s - loss: 0.0157 - dice_multi: 0.9359
Epoch 39/100
400/400 - 534s - loss: 0.0045 - dice_multi: 0.9528
Epoch 40/100
400/400 - 534s - loss: 0.0035 - dice_multi: 0.9535
Epoch 41/100
400/400 - 534s - loss: 0.0139 - dice_multi: 0.9359
Epoch 42/100
400/400 - 534s - loss: 0.0032 - dice_multi: 0.9535
Epoch 43/100
400/400 - 534s - loss: 0.0042 - dice_multi: 0.9508
Epoch 44/100
400/400 - 534s - loss: 0.0111 - dice_multi: 0.9405
Epoch 45/100
400/400 - 534s - loss: 0.0116 - dice_multi: 0.9415
Epoch 46/100
400/400 - 534s - loss: 0.0039 - dice_multi: 0.9534
Epoch 47/100
400/400 - 534s - loss: 0.0070 - dice_multi: 0.9466
Epoch 48/100
400/400 - 534s - loss: 0.0035 - dice_multi: 0.9531
Epoch 49/100
400/400 - 533s - loss: 0.0016 - dice_multi: 0.9555
Epoch 50/100
400/400 - 533s - loss: 0.0026 - dice_multi: 0.9525
Epoch 51/100
400/400 - 533s - loss: 0.0080 - dice_multi: 0.9424
Epoch 52/100
400/400 - 533s - loss: 0.0050 - dice_multi: 0.9501
Epoch 53/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9501
Epoch 54/100
400/400 - 533s - loss: 0.0095 - dice_multi: 0.9453
Epoch 55/100
400/400 - 533s - loss: 0.0029 - dice_multi: 0.9542
Epoch 56/100
400/400 - 533s - loss: 0.0021 - dice_multi: 0.9554
Epoch 57/100
400/400 - 533s - loss: 0.0024 - dice_multi: 0.9523
Epoch 58/100
400/400 - 533s - loss: 0.0118 - dice_multi: 0.9412
Epoch 59/100
400/400 - 533s - loss: 0.0050 - dice_multi: 0.9517
Epoch 60/100
400/400 - 533s - loss: 0.0042 - dice_multi: 0.9516
Epoch 61/100
400/400 - 533s - loss: 0.0032 - dice_multi: 0.9533
Epoch 62/100
400/400 - 534s - loss: 0.0025 - dice_multi: 0.9553
Epoch 63/100
400/400 - 533s - loss: 5.7735e-04 - dice_multi: 0.9544
Epoch 64/100
400/400 - 533s - loss: 0.0034 - dice_multi: 0.9503
Epoch 65/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9497
Epoch 66/100
400/400 - 533s - loss: 0.0015 - dice_multi: 0.9545
Epoch 67/100
400/400 - 533s - loss: 0.0023 - dice_multi: 0.9533
Epoch 68/100
400/400 - 533s - loss: 0.0116 - dice_multi: 0.9410
Epoch 69/100
400/400 - 533s - loss: 0.0037 - dice_multi: 0.9523
Epoch 70/100
400/400 - 533s - loss: 0.0022 - dice_multi: 0.9542
Epoch 71/100
400/400 - 533s - loss: 0.0018 - dice_multi: 0.9537
Epoch 72/100
400/400 - 533s - loss: 0.0045 - dice_multi: 0.9504
Epoch 73/100
400/400 - 533s - loss: 0.0125 - dice_multi: 0.9398
Epoch 74/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9528
Epoch 75/100
400/400 - 533s - loss: 0.0026 - dice_multi: 0.9549
Epoch 76/100
400/400 - 533s - loss: 0.0016 - dice_multi: 0.9559
Epoch 77/100
400/400 - 533s - loss: 0.0036 - dice_multi: 0.9525
Epoch 78/100
400/400 - 533s - loss: 0.0039 - dice_multi: 0.9506
Epoch 79/100
400/400 - 534s - loss: 0.0061 - dice_multi: 0.9492
Epoch 80/100
400/400 - 534s - loss: 0.0028 - dice_multi: 0.9545
Epoch 81/100
400/400 - 533s - loss: 0.0010 - dice_multi: 0.9565
Epoch 82/100
400/400 - 533s - loss: 0.0039 - dice_multi: 0.9514
Epoch 83/100
400/400 - 534s - loss: 0.0021 - dice_multi: 0.9558
Epoch 84/100
400/400 - 534s - loss: 0.0045 - dice_multi: 0.9519
Epoch 85/100
400/400 - 534s - loss: 7.1203e-04 - dice_multi: 0.9569
Epoch 86/100
400/400 - 534s - loss: -3.8409e-04 - dice_multi: 0.9562
Epoch 87/100
400/400 - 534s - loss: -9.6019e-04 - dice_multi: 0.9588
Epoch 88/100
400/400 - 534s - loss: -7.9586e-04 - dice_multi: 0.9571
Epoch 89/100
400/400 - 534s - loss: 0.0028 - dice_multi: 0.9494
Epoch 90/100
400/400 - 534s - loss: 0.0124 - dice_multi: 0.9420
Epoch 91/100
400/400 - 534s - loss: 0.0024 - dice_multi: 0.9561
Epoch 92/100
400/400 - 534s - loss: 0.0020 - dice_multi: 0.9544
Epoch 93/100
400/400 - 533s - loss: 0.0029 - dice_multi: 0.9523
Epoch 94/100
400/400 - 533s - loss: 7.7304e-04 - dice_multi: 0.9572
Epoch 95/100
400/400 - 533s - loss: -1.2236e-03 - dice_multi: 0.9580
Epoch 96/100
400/400 - 533s - loss: -3.4057e-04 - dice_multi: 0.9557
Epoch 97/100
400/400 - 533s - loss: 0.0035 - dice_multi: 0.9512
Epoch 98/100
400/400 - 534s - loss: 7.5641e-04 - dice_multi: 0.9563
Epoch 99/100
400/400 - 533s - loss: 0.0011 - dice_multi: 0.9545
Epoch 100/100
400/400 - 534s - loss: -2.7425e-04 - dice_multi: 0.9561
2022-01-21 00:53:50.437748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-21 00:53:50.444821: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-21 00:53:50.447009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-21 00:53:50.447066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-21 00:53:50.447079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-21 00:53:50.447088: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-21 00:53:50.447095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-21 00:53:50.448626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-21 00:53:50.449421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 53393.29398941994
executation time:145.69546920061111
---------fold--2---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 24 25 26 27 28 29 30 31 32 33 34 35
 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [12 13 14 15 16 17 18 19 20 21 22 23]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 541s - loss: 0.1304 - dice_multi: 0.6982
Epoch 2/100
400/400 - 534s - loss: 0.0822 - dice_multi: 0.7901
Epoch 3/100
400/400 - 534s - loss: 0.0720 - dice_multi: 0.8145
Epoch 4/100
400/400 - 534s - loss: 0.0536 - dice_multi: 0.8568
Epoch 5/100
400/400 - 534s - loss: 0.0516 - dice_multi: 0.8583
Epoch 6/100
400/400 - 534s - loss: 0.0361 - dice_multi: 0.8907
Epoch 7/100
400/400 - 534s - loss: 0.0390 - dice_multi: 0.8858
Epoch 8/100
400/400 - 534s - loss: 0.0251 - dice_multi: 0.9124
Epoch 9/100
400/400 - 534s - loss: 0.0246 - dice_multi: 0.9160
Epoch 10/100
400/400 - 534s - loss: 0.0310 - dice_multi: 0.9054
Epoch 11/100
400/400 - 534s - loss: 0.0155 - dice_multi: 0.9341
Epoch 12/100
400/400 - 534s - loss: 0.0120 - dice_multi: 0.9407
Epoch 13/100
400/400 - 534s - loss: 0.0213 - dice_multi: 0.9225
Epoch 14/100
400/400 - 534s - loss: 0.0167 - dice_multi: 0.9351
Epoch 15/100
400/400 - 534s - loss: 0.0152 - dice_multi: 0.9373
Epoch 16/100
400/400 - 534s - loss: 0.0102 - dice_multi: 0.9427
Epoch 17/100
400/400 - 534s - loss: 0.0218 - dice_multi: 0.9205
Epoch 18/100
400/400 - 534s - loss: 0.0285 - dice_multi: 0.9103
Epoch 19/100
400/400 - 534s - loss: 0.0142 - dice_multi: 0.9407
Epoch 20/100
400/400 - 534s - loss: 0.0100 - dice_multi: 0.9456
Epoch 21/100
400/400 - 534s - loss: 0.0114 - dice_multi: 0.9415
Epoch 22/100
400/400 - 534s - loss: 0.0165 - dice_multi: 0.9354
Epoch 23/100
400/400 - 534s - loss: 0.0086 - dice_multi: 0.9473
Epoch 24/100
400/400 - 534s - loss: 0.0133 - dice_multi: 0.9393
Epoch 25/100
400/400 - 534s - loss: 0.0363 - dice_multi: 0.9053
Epoch 26/100
400/400 - 534s - loss: 0.0176 - dice_multi: 0.9341
Epoch 27/100
400/400 - 534s - loss: 0.0096 - dice_multi: 0.9477
Epoch 28/100
400/400 - 534s - loss: 0.0095 - dice_multi: 0.9471
Epoch 29/100
400/400 - 534s - loss: 0.0079 - dice_multi: 0.9491
Epoch 30/100
400/400 - 534s - loss: 0.0076 - dice_multi: 0.9491
Epoch 31/100
400/400 - 534s - loss: 0.0043 - dice_multi: 0.9527
Epoch 32/100
400/400 - 534s - loss: 0.0049 - dice_multi: 0.9500
Epoch 33/100
400/400 - 534s - loss: 0.0049 - dice_multi: 0.9511
Epoch 34/100
400/400 - 534s - loss: 0.0096 - dice_multi: 0.9443
Epoch 35/100
400/400 - 534s - loss: 0.0259 - dice_multi: 0.9166
Epoch 36/100
400/400 - 534s - loss: 0.0133 - dice_multi: 0.9419
Epoch 37/100
400/400 - 534s - loss: 0.0061 - dice_multi: 0.9520
Epoch 38/100
400/400 - 534s - loss: 0.0055 - dice_multi: 0.9529
Epoch 39/100
400/400 - 534s - loss: 0.0038 - dice_multi: 0.9528
Epoch 40/100
400/400 - 534s - loss: 0.0137 - dice_multi: 0.9329
Epoch 41/100
400/400 - 534s - loss: 0.0099 - dice_multi: 0.9451
Epoch 42/100
400/400 - 534s - loss: 0.0074 - dice_multi: 0.9481
Epoch 43/100
400/400 - 534s - loss: 0.0042 - dice_multi: 0.9538
Epoch 44/100
400/400 - 534s - loss: 0.0025 - dice_multi: 0.9540
Epoch 45/100
400/400 - 534s - loss: 0.0028 - dice_multi: 0.9537
Epoch 46/100
400/400 - 534s - loss: 0.0051 - dice_multi: 0.9490
Epoch 47/100
400/400 - 534s - loss: 0.0180 - dice_multi: 0.9314
Epoch 48/100
400/400 - 534s - loss: 0.0115 - dice_multi: 0.9413
Epoch 49/100
400/400 - 534s - loss: 0.0060 - dice_multi: 0.9497
Epoch 50/100
400/400 - 534s - loss: 0.0040 - dice_multi: 0.9525
Epoch 51/100
400/400 - 534s - loss: 0.0026 - dice_multi: 0.9542
Epoch 52/100
400/400 - 534s - loss: 0.0027 - dice_multi: 0.9528
Epoch 53/100
400/400 - 534s - loss: 0.0166 - dice_multi: 0.9338
Epoch 54/100
400/400 - 534s - loss: 0.0057 - dice_multi: 0.9515
Epoch 55/100
400/400 - 534s - loss: 0.0129 - dice_multi: 0.9407
Epoch 56/100
400/400 - 534s - loss: 0.0144 - dice_multi: 0.9386
Epoch 57/100
400/400 - 534s - loss: 0.0045 - dice_multi: 0.9526
Epoch 58/100
400/400 - 534s - loss: 0.0045 - dice_multi: 0.9521
Epoch 59/100
400/400 - 534s - loss: 0.0027 - dice_multi: 0.9539
Epoch 60/100
400/400 - 534s - loss: 0.0149 - dice_multi: 0.9342
Epoch 61/100
400/400 - 534s - loss: 0.0060 - dice_multi: 0.9500
Epoch 62/100
400/400 - 534s - loss: 0.0029 - dice_multi: 0.9540
Epoch 63/100
400/400 - 534s - loss: 0.0027 - dice_multi: 0.9549
Epoch 64/100
400/400 - 534s - loss: 0.0011 - dice_multi: 0.9554
Epoch 65/100
400/400 - 534s - loss: 0.0015 - dice_multi: 0.9543
Epoch 66/100
400/400 - 534s - loss: 0.0090 - dice_multi: 0.9435
Epoch 67/100
400/400 - 534s - loss: 0.0044 - dice_multi: 0.9529
Epoch 68/100
400/400 - 534s - loss: 0.0022 - dice_multi: 0.9554
Epoch 69/100
400/400 - 534s - loss: 0.0010 - dice_multi: 0.9546
Epoch 70/100
400/400 - 534s - loss: 0.0018 - dice_multi: 0.9549
Epoch 71/100
400/400 - 534s - loss: 0.0020 - dice_multi: 0.9531
Epoch 72/100
400/400 - 534s - loss: 0.0013 - dice_multi: 0.9537
Epoch 73/100
400/400 - 534s - loss: 0.0101 - dice_multi: 0.9394
Epoch 74/100
400/400 - 534s - loss: 0.0097 - dice_multi: 0.9438
Epoch 75/100
400/400 - 534s - loss: 0.0035 - dice_multi: 0.9539
Epoch 76/100
400/400 - 534s - loss: 0.0020 - dice_multi: 0.9536
Epoch 77/100
400/400 - 534s - loss: 0.0010 - dice_multi: 0.9553
Epoch 78/100
400/400 - 534s - loss: 0.0080 - dice_multi: 0.9426
Epoch 79/100
400/400 - 534s - loss: 0.0019 - dice_multi: 0.9556
Epoch 80/100
400/400 - 534s - loss: 0.0020 - dice_multi: 0.9545
Epoch 81/100
400/400 - 534s - loss: 0.0115 - dice_multi: 0.9403
Epoch 82/100
400/400 - 534s - loss: 0.0029 - dice_multi: 0.9549
Epoch 83/100
400/400 - 534s - loss: 0.0018 - dice_multi: 0.9552
Epoch 84/100
400/400 - 534s - loss: 0.0038 - dice_multi: 0.9521
Epoch 85/100
400/400 - 534s - loss: 0.0017 - dice_multi: 0.9553
Epoch 86/100
400/400 - 534s - loss: 6.7351e-04 - dice_multi: 0.9568
Epoch 87/100
400/400 - 534s - loss: 6.0295e-04 - dice_multi: 0.9561
Epoch 88/100
400/400 - 534s - loss: 0.0036 - dice_multi: 0.9503
Epoch 89/100
400/400 - 534s - loss: 0.0103 - dice_multi: 0.9412
Epoch 90/100
400/400 - 534s - loss: 0.0044 - dice_multi: 0.9540
Epoch 91/100
400/400 - 534s - loss: 0.0014 - dice_multi: 0.9567
Epoch 92/100
400/400 - 534s - loss: 0.0012 - dice_multi: 0.9561
Epoch 93/100
400/400 - 534s - loss: 9.1459e-04 - dice_multi: 0.9569
Epoch 94/100
400/400 - 534s - loss: 1.2219e-04 - dice_multi: 0.9574
Epoch 95/100
400/400 - 534s - loss: 7.7325e-04 - dice_multi: 0.9564
Epoch 96/100
400/400 - 534s - loss: 0.0021 - dice_multi: 0.9533
Epoch 97/100
400/400 - 534s - loss: 1.7392e-04 - dice_multi: 0.9559
Epoch 98/100
400/400 - 534s - loss: 0.0010 - dice_multi: 0.9550
Epoch 99/100
400/400 - 534s - loss: 0.0098 - dice_multi: 0.9402
Epoch 100/100
400/400 - 534s - loss: 0.0056 - dice_multi: 0.9502
2022-01-21 16:13:51.485764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-21 16:13:51.507451: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-21 16:13:51.509642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-21 16:13:51.509697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-21 16:13:51.509709: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-21 16:13:51.509718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-21 16:13:51.509726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-21 16:13:51.511257: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-21 16:13:51.512051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 53442.079637765884
executation time:145.87153454621634
---------fold--3---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [24 25 26 27 28 29 30 31 32 33 34 35]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 540s - loss: 0.1235 - dice_multi: 0.7084
Epoch 2/100
400/400 - 533s - loss: 0.0871 - dice_multi: 0.7886
Epoch 3/100
400/400 - 533s - loss: 0.0686 - dice_multi: 0.8250
Epoch 4/100
400/400 - 533s - loss: 0.0562 - dice_multi: 0.8609
Epoch 5/100
400/400 - 533s - loss: 0.0530 - dice_multi: 0.8611
Epoch 6/100
400/400 - 533s - loss: 0.0364 - dice_multi: 0.8978
Epoch 7/100
400/400 - 533s - loss: 0.0240 - dice_multi: 0.9217
Epoch 8/100
400/400 - 533s - loss: 0.0240 - dice_multi: 0.9170
Epoch 9/100
400/400 - 533s - loss: 0.0173 - dice_multi: 0.9305
Epoch 10/100
400/400 - 534s - loss: 0.0143 - dice_multi: 0.9360
Epoch 11/100
400/400 - 534s - loss: 0.0157 - dice_multi: 0.9301
Epoch 12/100
400/400 - 533s - loss: 0.0174 - dice_multi: 0.9309
Epoch 13/100
400/400 - 534s - loss: 0.0215 - dice_multi: 0.9254
Epoch 14/100
400/400 - 534s - loss: 0.0091 - dice_multi: 0.9457
Epoch 15/100
400/400 - 534s - loss: 0.0128 - dice_multi: 0.9376
Epoch 16/100
400/400 - 534s - loss: 0.0259 - dice_multi: 0.9187
Epoch 17/100
400/400 - 534s - loss: 0.0112 - dice_multi: 0.9434
Epoch 18/100
400/400 - 534s - loss: 0.0430 - dice_multi: 0.8837
Epoch 19/100
400/400 - 533s - loss: 0.0116 - dice_multi: 0.9457
Epoch 20/100
400/400 - 534s - loss: 0.0079 - dice_multi: 0.9484
Epoch 21/100
400/400 - 534s - loss: 0.0089 - dice_multi: 0.9464
Epoch 22/100
400/400 - 533s - loss: 0.0073 - dice_multi: 0.9468
Epoch 23/100
400/400 - 534s - loss: 0.0114 - dice_multi: 0.9420
Epoch 24/100
400/400 - 534s - loss: 0.0047 - dice_multi: 0.9490
Epoch 25/100
400/400 - 534s - loss: 0.0246 - dice_multi: 0.9156
Epoch 26/100
400/400 - 534s - loss: 0.0098 - dice_multi: 0.9453
Epoch 27/100
400/400 - 534s - loss: 0.0089 - dice_multi: 0.9473
Epoch 28/100
400/400 - 534s - loss: 0.0050 - dice_multi: 0.9513
Epoch 29/100
400/400 - 534s - loss: 0.0329 - dice_multi: 0.9031
Epoch 30/100
400/400 - 534s - loss: 0.0180 - dice_multi: 0.9327
Epoch 31/100
400/400 - 533s - loss: 0.0091 - dice_multi: 0.9475
Epoch 32/100
400/400 - 533s - loss: 0.0068 - dice_multi: 0.9511
Epoch 33/100
400/400 - 533s - loss: 0.0104 - dice_multi: 0.9426
Epoch 34/100
400/400 - 533s - loss: 0.0203 - dice_multi: 0.9268
Epoch 35/100
400/400 - 534s - loss: 0.0098 - dice_multi: 0.9452
Epoch 36/100
400/400 - 533s - loss: 0.0072 - dice_multi: 0.9500
Epoch 37/100
400/400 - 533s - loss: 0.0044 - dice_multi: 0.9538
Epoch 38/100
400/400 - 533s - loss: 0.0043 - dice_multi: 0.9524
Epoch 39/100
400/400 - 533s - loss: 0.0126 - dice_multi: 0.9346
Epoch 40/100
400/400 - 533s - loss: 0.0067 - dice_multi: 0.9506
Epoch 41/100
400/400 - 534s - loss: 0.0045 - dice_multi: 0.9507
Epoch 42/100
400/400 - 534s - loss: 0.0129 - dice_multi: 0.9383
Epoch 43/100
400/400 - 534s - loss: 0.0126 - dice_multi: 0.9412
Epoch 44/100
400/400 - 533s - loss: 0.0130 - dice_multi: 0.9410
Epoch 45/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9536
Epoch 46/100
400/400 - 533s - loss: 0.0037 - dice_multi: 0.9535
Epoch 47/100
400/400 - 533s - loss: 0.0144 - dice_multi: 0.9366
Epoch 48/100
400/400 - 533s - loss: 0.0069 - dice_multi: 0.9518
Epoch 49/100
400/400 - 534s - loss: 0.0050 - dice_multi: 0.9512
Epoch 50/100
400/400 - 533s - loss: 0.0025 - dice_multi: 0.9548
Epoch 51/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9506
Epoch 52/100
400/400 - 533s - loss: 0.0045 - dice_multi: 0.9528
Epoch 53/100
400/400 - 533s - loss: 0.0084 - dice_multi: 0.9463
Epoch 54/100
400/400 - 533s - loss: 0.0032 - dice_multi: 0.9544
Epoch 55/100
400/400 - 533s - loss: 0.0109 - dice_multi: 0.9411
Epoch 56/100
400/400 - 533s - loss: 0.0063 - dice_multi: 0.9495
Epoch 57/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9523
Epoch 58/100
400/400 - 533s - loss: 0.0025 - dice_multi: 0.9556
Epoch 59/100
400/400 - 533s - loss: 0.0021 - dice_multi: 0.9552
Epoch 60/100
400/400 - 533s - loss: 0.0026 - dice_multi: 0.9529
Epoch 61/100
400/400 - 533s - loss: 0.0172 - dice_multi: 0.9336
Epoch 62/100
400/400 - 533s - loss: 0.0082 - dice_multi: 0.9505
Epoch 63/100
400/400 - 533s - loss: 0.0034 - dice_multi: 0.9548
Epoch 64/100
400/400 - 533s - loss: 0.0019 - dice_multi: 0.9555
Epoch 65/100
400/400 - 534s - loss: 0.0012 - dice_multi: 0.9562
Epoch 66/100
400/400 - 533s - loss: 0.0100 - dice_multi: 0.9445
Epoch 67/100
400/400 - 534s - loss: 0.0029 - dice_multi: 0.9541
Epoch 68/100
400/400 - 533s - loss: 0.0024 - dice_multi: 0.9549
Epoch 69/100
400/400 - 533s - loss: 0.0018 - dice_multi: 0.9558
Epoch 70/100
400/400 - 533s - loss: 0.0101 - dice_multi: 0.9416
Epoch 71/100
400/400 - 533s - loss: 0.0149 - dice_multi: 0.9406
Epoch 72/100
400/400 - 533s - loss: 0.0062 - dice_multi: 0.9521
Epoch 73/100
400/400 - 533s - loss: 0.0034 - dice_multi: 0.9575
Epoch 74/100
400/400 - 533s - loss: 0.0027 - dice_multi: 0.9548
Epoch 75/100
400/400 - 533s - loss: 0.0094 - dice_multi: 0.9431
Epoch 76/100
400/400 - 533s - loss: 0.0059 - dice_multi: 0.9502
Epoch 77/100
400/400 - 533s - loss: 0.0054 - dice_multi: 0.9513
Epoch 78/100
400/400 - 533s - loss: 0.0022 - dice_multi: 0.9579
Epoch 79/100
400/400 - 533s - loss: 0.0015 - dice_multi: 0.9569
Epoch 80/100
400/400 - 533s - loss: 7.3186e-04 - dice_multi: 0.9579
Epoch 81/100
400/400 - 533s - loss: 0.0062 - dice_multi: 0.9477
Epoch 82/100
400/400 - 533s - loss: 0.0046 - dice_multi: 0.9535
Epoch 83/100
400/400 - 533s - loss: 0.0083 - dice_multi: 0.9459
Epoch 84/100
400/400 - 533s - loss: 0.0025 - dice_multi: 0.9565
Epoch 85/100
400/400 - 533s - loss: 0.0012 - dice_multi: 0.9563
Epoch 86/100
400/400 - 533s - loss: 0.0057 - dice_multi: 0.9472
Epoch 87/100
400/400 - 533s - loss: 0.0040 - dice_multi: 0.9532
Epoch 88/100
400/400 - 533s - loss: 0.0033 - dice_multi: 0.9545
Epoch 89/100
400/400 - 533s - loss: 0.0015 - dice_multi: 0.9565
Epoch 90/100
400/400 - 533s - loss: 4.6979e-04 - dice_multi: 0.9572
Epoch 91/100
400/400 - 533s - loss: -6.0010e-05 - dice_multi: 0.9576
Epoch 92/100
400/400 - 533s - loss: 5.0901e-04 - dice_multi: 0.9565
Epoch 93/100
400/400 - 533s - loss: 4.0992e-04 - dice_multi: 0.9571
Epoch 94/100
400/400 - 533s - loss: 0.0067 - dice_multi: 0.9459
Epoch 95/100
400/400 - 533s - loss: 0.0044 - dice_multi: 0.9528
Epoch 96/100
400/400 - 533s - loss: 0.0014 - dice_multi: 0.9573
Epoch 97/100
400/400 - 534s - loss: 0.0034 - dice_multi: 0.9528
Epoch 98/100
400/400 - 534s - loss: 0.0063 - dice_multi: 0.9492
Epoch 99/100
400/400 - 534s - loss: 0.0012 - dice_multi: 0.9573
Epoch 100/100
400/400 - 534s - loss: 2.4169e-04 - dice_multi: 0.9591
2022-01-22 07:32:09.285629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-22 07:32:09.287079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-22 07:32:09.289214: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-22 07:32:09.289275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-22 07:32:09.289288: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-22 07:32:09.289296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-22 07:32:09.289304: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-22 07:32:09.290786: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-22 07:32:09.291577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 53337.83457636833
executation time:145.9353427886963
---------fold--4---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 48 49 50 51 52 53 54 55 56 57 58 59]
training set size:  48
testing set:  [36 37 38 39 40 41 42 43 44 45 46 47]
testing set size:  12
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 541s - loss: 0.1053 - dice_multi: 0.7126
Epoch 2/100
400/400 - 533s - loss: 0.0519 - dice_multi: 0.8412
Epoch 3/100
400/400 - 533s - loss: 0.0382 - dice_multi: 0.8829
Epoch 4/100
400/400 - 534s - loss: 0.0276 - dice_multi: 0.9131
Epoch 5/100
400/400 - 534s - loss: 0.0300 - dice_multi: 0.9037
Epoch 6/100
400/400 - 534s - loss: 0.0178 - dice_multi: 0.9290
Epoch 7/100
400/400 - 534s - loss: 0.0143 - dice_multi: 0.9358
Epoch 8/100
400/400 - 534s - loss: 0.0165 - dice_multi: 0.9262
Epoch 9/100
400/400 - 534s - loss: 0.0128 - dice_multi: 0.9328
Epoch 10/100
400/400 - 534s - loss: 0.0094 - dice_multi: 0.9381
Epoch 11/100
400/400 - 534s - loss: 0.0098 - dice_multi: 0.9384
Epoch 12/100
400/400 - 534s - loss: 0.0074 - dice_multi: 0.9399
Epoch 13/100
400/400 - 534s - loss: 0.0054 - dice_multi: 0.9441
Epoch 14/100
400/400 - 534s - loss: 0.0133 - dice_multi: 0.9285
Epoch 15/100
400/400 - 533s - loss: 0.0053 - dice_multi: 0.9462
Epoch 16/100
400/400 - 534s - loss: 0.0053 - dice_multi: 0.9458
Epoch 17/100
400/400 - 534s - loss: 0.0112 - dice_multi: 0.9332
Epoch 18/100
400/400 - 533s - loss: 0.0075 - dice_multi: 0.9440
Epoch 19/100
400/400 - 533s - loss: 0.0022 - dice_multi: 0.9499
Epoch 20/100
400/400 - 533s - loss: 0.0102 - dice_multi: 0.9344
Epoch 21/100
400/400 - 533s - loss: 0.0035 - dice_multi: 0.9488
Epoch 22/100
400/400 - 533s - loss: 0.0020 - dice_multi: 0.9503
Epoch 23/100
400/400 - 533s - loss: 0.0073 - dice_multi: 0.9409
Epoch 24/100
400/400 - 533s - loss: 0.0086 - dice_multi: 0.9416
Epoch 25/100
400/400 - 533s - loss: 0.0022 - dice_multi: 0.9502
Epoch 26/100
400/400 - 533s - loss: 0.0012 - dice_multi: 0.9517
Epoch 27/100
400/400 - 533s - loss: 0.0093 - dice_multi: 0.9396
Epoch 28/100
400/400 - 534s - loss: 0.0050 - dice_multi: 0.9475
Epoch 29/100
400/400 - 533s - loss: 9.3578e-04 - dice_multi: 0.9529
Epoch 30/100
400/400 - 533s - loss: 8.6514e-04 - dice_multi: 0.9516
Epoch 31/100
400/400 - 533s - loss: 0.0027 - dice_multi: 0.9492
Epoch 32/100
400/400 - 533s - loss: 4.7080e-04 - dice_multi: 0.9516
Epoch 33/100
400/400 - 533s - loss: 0.0044 - dice_multi: 0.9450
Epoch 34/100
400/400 - 533s - loss: 8.4632e-04 - dice_multi: 0.9516
Epoch 35/100
400/400 - 533s - loss: 0.0032 - dice_multi: 0.9474
Epoch 36/100
400/400 - 533s - loss: 5.7280e-04 - dice_multi: 0.9535
Epoch 37/100
400/400 - 533s - loss: -1.1966e-04 - dice_multi: 0.9517
Epoch 38/100
400/400 - 533s - loss: 0.0058 - dice_multi: 0.9451
Epoch 39/100
400/400 - 534s - loss: 0.0012 - dice_multi: 0.9527
Epoch 40/100
400/400 - 533s - loss: 5.2736e-05 - dice_multi: 0.9520
Epoch 41/100
400/400 - 533s - loss: 7.7675e-04 - dice_multi: 0.9527
Epoch 42/100
400/400 - 533s - loss: 0.0076 - dice_multi: 0.9385
Epoch 43/100
400/400 - 533s - loss: 0.0019 - dice_multi: 0.9519
Epoch 44/100
400/400 - 533s - loss: -3.7961e-04 - dice_multi: 0.9535
Epoch 45/100
400/400 - 533s - loss: -1.2752e-03 - dice_multi: 0.9537
Epoch 46/100
400/400 - 533s - loss: 0.0011 - dice_multi: 0.9492
Epoch 47/100
400/400 - 533s - loss: 0.0031 - dice_multi: 0.9484
Epoch 48/100
400/400 - 533s - loss: -6.0061e-04 - dice_multi: 0.9537
Epoch 49/100
400/400 - 533s - loss: -9.4502e-04 - dice_multi: 0.9539
Epoch 50/100
400/400 - 533s - loss: 0.0069 - dice_multi: 0.9426
Epoch 51/100
400/400 - 533s - loss: -1.2140e-04 - dice_multi: 0.9535
Epoch 52/100
400/400 - 533s - loss: -1.1296e-03 - dice_multi: 0.9553
Epoch 53/100
400/400 - 533s - loss: -1.5659e-03 - dice_multi: 0.9531
Epoch 54/100
400/400 - 533s - loss: 0.0011 - dice_multi: 0.9508
Epoch 55/100
400/400 - 533s - loss: 4.7085e-04 - dice_multi: 0.9522
Epoch 56/100
400/400 - 533s - loss: -8.4386e-04 - dice_multi: 0.9544
Epoch 57/100
400/400 - 533s - loss: -1.9174e-03 - dice_multi: 0.9553
Epoch 58/100
400/400 - 533s - loss: 4.5390e-04 - dice_multi: 0.9496
Epoch 59/100
400/400 - 533s - loss: 6.2152e-05 - dice_multi: 0.9538
Epoch 60/100
400/400 - 533s - loss: 0.0018 - dice_multi: 0.9506
Epoch 61/100
400/400 - 533s - loss: -3.7599e-04 - dice_multi: 0.9539
Epoch 62/100
400/400 - 533s - loss: -2.1844e-03 - dice_multi: 0.9557
Epoch 63/100
400/400 - 533s - loss: -1.0771e-04 - dice_multi: 0.9527
Epoch 64/100
400/400 - 533s - loss: -1.4548e-03 - dice_multi: 0.9546
Epoch 65/100
400/400 - 533s - loss: -5.1873e-04 - dice_multi: 0.9525
Epoch 66/100
400/400 - 533s - loss: 8.2868e-05 - dice_multi: 0.9517
Epoch 67/100
400/400 - 533s - loss: -2.2150e-03 - dice_multi: 0.9558
Epoch 68/100
400/400 - 533s - loss: -2.4326e-03 - dice_multi: 0.9542
Epoch 69/100
400/400 - 533s - loss: -3.0945e-04 - dice_multi: 0.9505
Epoch 70/100
400/400 - 533s - loss: -1.5652e-03 - dice_multi: 0.9558
Epoch 71/100
400/400 - 534s - loss: 0.0029 - dice_multi: 0.9458
Epoch 72/100
400/400 - 534s - loss: 1.1461e-05 - dice_multi: 0.9541
Epoch 73/100
400/400 - 534s - loss: -7.5428e-05 - dice_multi: 0.9520
Epoch 74/100
400/400 - 533s - loss: -1.7766e-03 - dice_multi: 0.9542
Epoch 75/100
400/400 - 533s - loss: -2.3610e-03 - dice_multi: 0.9567
Epoch 76/100
400/400 - 534s - loss: -3.1510e-03 - dice_multi: 0.9557
Epoch 77/100
400/400 - 533s - loss: 9.1989e-04 - dice_multi: 0.9484
Epoch 78/100
400/400 - 533s - loss: 8.1284e-04 - dice_multi: 0.9523
Epoch 79/100
400/400 - 534s - loss: -1.8629e-03 - dice_multi: 0.9557
Epoch 80/100
400/400 - 533s - loss: -2.4233e-03 - dice_multi: 0.9556
Epoch 81/100
400/400 - 533s - loss: -2.5042e-03 - dice_multi: 0.9572
Epoch 82/100
400/400 - 533s - loss: -4.9941e-04 - dice_multi: 0.9508
Epoch 83/100
400/400 - 533s - loss: -2.6221e-03 - dice_multi: 0.9551
Epoch 84/100
400/400 - 533s - loss: -1.6906e-03 - dice_multi: 0.9537
Epoch 85/100
400/400 - 533s - loss: -1.8490e-03 - dice_multi: 0.9551
Epoch 86/100
400/400 - 534s - loss: -2.5343e-03 - dice_multi: 0.9576
Epoch 87/100
400/400 - 533s - loss: 9.2632e-04 - dice_multi: 0.9489
Epoch 88/100
400/400 - 533s - loss: -1.1993e-03 - dice_multi: 0.9544
Epoch 89/100
400/400 - 533s - loss: -2.9326e-03 - dice_multi: 0.9561
Epoch 90/100
400/400 - 533s - loss: 0.0024 - dice_multi: 0.9465
Epoch 91/100
400/400 - 533s - loss: 3.8499e-04 - dice_multi: 0.9527
Epoch 92/100
400/400 - 533s - loss: -2.0166e-03 - dice_multi: 0.9556
Epoch 93/100
400/400 - 533s - loss: -2.3186e-03 - dice_multi: 0.9557
Epoch 94/100
400/400 - 533s - loss: -2.6715e-03 - dice_multi: 0.9567
Epoch 95/100
400/400 - 533s - loss: -3.3837e-03 - dice_multi: 0.9580
Epoch 96/100
400/400 - 533s - loss: -1.9866e-03 - dice_multi: 0.9555
Epoch 97/100
400/400 - 533s - loss: -3.2788e-03 - dice_multi: 0.9566
Epoch 98/100
400/400 - 533s - loss: 0.0018 - dice_multi: 0.9495
Epoch 99/100
400/400 - 533s - loss: -1.5120e-03 - dice_multi: 0.9555
Epoch 100/100
400/400 - 533s - loss: -2.9756e-03 - dice_multi: 0.9572
2022-01-22 22:50:28.676890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 0 with properties: 
pciBusID: 0000:03:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-22 22:50:28.692432: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1734] Found device 1 with properties: 
pciBusID: 0000:82:00.0 name: Tesla P100-PCIE-12GB computeCapability: 6.0
coreClock: 1.3285GHz coreCount: 56 deviceMemorySize: 11.91GiB deviceMemoryBandwidth: 511.41GiB/s
2022-01-22 22:50:28.694424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1872] Adding visible gpu devices: 0, 1
2022-01-22 22:50:28.694481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-22 22:50:28.694492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 1 
2022-01-22 22:50:28.694500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N N 
2022-01-22 22:50:28.694507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 1:   N N 
2022-01-22 22:50:28.695927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11158 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-01-22 22:50:28.696646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11158 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
training time: 53334.913023233414
executation time:146.33253208796182
---------fold--5---------
training set:  [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47]
training set size:  48
testing set:  [48 49 50 51 52 53 54 55 56 57 58 59 60 61 62]
testing set size:  15
..generator_len: 400
..training_n_subject: 48
..training_n_patch_per_sub: 326592
Epoch 1/100
400/400 - 540s - loss: 0.1347 - dice_multi: 0.6999
Epoch 2/100
400/400 - 533s - loss: 0.0834 - dice_multi: 0.7954
Epoch 3/100
400/400 - 533s - loss: 0.0547 - dice_multi: 0.8547
Epoch 4/100
400/400 - 533s - loss: 0.0459 - dice_multi: 0.8833
Epoch 5/100
400/400 - 533s - loss: 0.0304 - dice_multi: 0.9107
Epoch 6/100
400/400 - 533s - loss: 0.0272 - dice_multi: 0.9150
Epoch 7/100
400/400 - 533s - loss: 0.0219 - dice_multi: 0.9213
Epoch 8/100
400/400 - 533s - loss: 0.0300 - dice_multi: 0.9085
Epoch 9/100
400/400 - 533s - loss: 0.0297 - dice_multi: 0.9058
Epoch 10/100
400/400 - 533s - loss: 0.0159 - dice_multi: 0.9354
Epoch 11/100
400/400 - 533s - loss: 0.0197 - dice_multi: 0.9285
Epoch 12/100
400/400 - 533s - loss: 0.0225 - dice_multi: 0.9233
Epoch 13/100
400/400 - 533s - loss: 0.0136 - dice_multi: 0.9371
Epoch 14/100
400/400 - 533s - loss: 0.0133 - dice_multi: 0.9390
Epoch 15/100
400/400 - 533s - loss: 0.0092 - dice_multi: 0.9434
Epoch 16/100
400/400 - 533s - loss: 0.0070 - dice_multi: 0.9467
Epoch 17/100
400/400 - 533s - loss: 0.0300 - dice_multi: 0.9092
Epoch 18/100
400/400 - 533s - loss: 0.0141 - dice_multi: 0.9363
Epoch 19/100
400/400 - 533s - loss: 0.0116 - dice_multi: 0.9396
Epoch 20/100
400/400 - 533s - loss: 0.0076 - dice_multi: 0.9474
Epoch 21/100
400/400 - 533s - loss: 0.0061 - dice_multi: 0.9474
Epoch 22/100
400/400 - 533s - loss: 0.0326 - dice_multi: 0.9046
Epoch 23/100
400/400 - 533s - loss: 0.0181 - dice_multi: 0.9289
Epoch 24/100
400/400 - 533s - loss: 0.0120 - dice_multi: 0.9412
Epoch 25/100
400/400 - 533s - loss: 0.0076 - dice_multi: 0.9461
Epoch 26/100
400/400 - 533s - loss: 0.0052 - dice_multi: 0.9489
Epoch 27/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9510
Epoch 28/100
400/400 - 533s - loss: 0.0190 - dice_multi: 0.9309
Epoch 29/100
400/400 - 533s - loss: 0.0153 - dice_multi: 0.9338
Epoch 30/100
400/400 - 533s - loss: 0.0057 - dice_multi: 0.9507
Epoch 31/100
400/400 - 533s - loss: 0.0063 - dice_multi: 0.9486
Epoch 32/100
400/400 - 533s - loss: 0.0048 - dice_multi: 0.9502
Epoch 33/100
400/400 - 533s - loss: 0.0167 - dice_multi: 0.9333
Epoch 34/100
400/400 - 533s - loss: 0.0088 - dice_multi: 0.9465
Epoch 35/100
400/400 - 533s - loss: 0.0057 - dice_multi: 0.9513
Epoch 36/100
400/400 - 533s - loss: 0.0086 - dice_multi: 0.9467
Epoch 37/100
400/400 - 533s - loss: 0.0037 - dice_multi: 0.9518
Epoch 38/100
400/400 - 533s - loss: 0.0056 - dice_multi: 0.9475
Epoch 39/100
400/400 - 533s - loss: 0.0034 - dice_multi: 0.9516
Epoch 40/100
400/400 - 533s - loss: 0.0029 - dice_multi: 0.9518
Epoch 41/100
400/400 - 533s - loss: 0.0145 - dice_multi: 0.9364
Epoch 42/100
400/400 - 533s - loss: 0.0074 - dice_multi: 0.9475
Epoch 43/100
400/400 - 533s - loss: 0.0031 - dice_multi: 0.9539
Epoch 44/100
400/400 - 533s - loss: 0.0030 - dice_multi: 0.9519
Epoch 45/100
400/400 - 533s - loss: 0.0012 - dice_multi: 0.9552
Epoch 46/100
400/400 - 533s - loss: 0.0138 - dice_multi: 0.9337
Epoch 47/100
400/400 - 533s - loss: 0.0062 - dice_multi: 0.9505
Epoch 48/100
400/400 - 533s - loss: 0.0030 - dice_multi: 0.9529
Epoch 49/100
400/400 - 533s - loss: 0.0012 - dice_multi: 0.9534
Epoch 50/100
400/400 - 533s - loss: 0.0017 - dice_multi: 0.9524
Epoch 51/100
400/400 - 533s - loss: 0.0140 - dice_multi: 0.9326
Epoch 52/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9494
Epoch 53/100
400/400 - 533s - loss: 0.0047 - dice_multi: 0.9515
Epoch 54/100
400/400 - 533s - loss: 0.0012 - dice_multi: 0.9547
Epoch 55/100
400/400 - 533s - loss: 0.0019 - dice_multi: 0.9554
Epoch 56/100
400/400 - 533s - loss: 0.0151 - dice_multi: 0.9348
Epoch 57/100
400/400 - 533s - loss: 0.0042 - dice_multi: 0.9526
Epoch 58/100
400/400 - 533s - loss: 0.0023 - dice_multi: 0.9533
Epoch 59/100
400/400 - 533s - loss: 0.0011 - dice_multi: 0.9555
Epoch 60/100
400/400 - 533s - loss: 0.0062 - dice_multi: 0.9469
Epoch 61/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9517
Epoch 62/100
400/400 - 533s - loss: 0.0013 - dice_multi: 0.9543
Epoch 63/100
400/400 - 533s - loss: 0.0020 - dice_multi: 0.9519
Epoch 64/100
400/400 - 533s - loss: 0.0099 - dice_multi: 0.9423
Epoch 65/100
400/400 - 533s - loss: 0.0029 - dice_multi: 0.9537
Epoch 66/100
400/400 - 533s - loss: 0.0049 - dice_multi: 0.9513
Epoch 67/100
400/400 - 533s - loss: 0.0029 - dice_multi: 0.9537
Epoch 68/100
400/400 - 533s - loss: 9.3934e-04 - dice_multi: 0.9547
Epoch 69/100
400/400 - 533s - loss: 4.2725e-04 - dice_multi: 0.9548
Epoch 70/100
400/400 - 533s - loss: 0.0019 - dice_multi: 0.9522
Epoch 71/100
400/400 - 533s - loss: 0.0025 - dice_multi: 0.9533
Epoch 72/100
400/400 - 533s - loss: 0.0066 - dice_multi: 0.9472
Epoch 73/100
400/400 - 533s - loss: 0.0023 - dice_multi: 0.9536
Epoch 74/100
400/400 - 534s - loss: 0.0017 - dice_multi: 0.9547
Epoch 75/100
400/400 - 533s - loss: 1.7574e-04 - dice_multi: 0.9570
Epoch 76/100
400/400 - 533s - loss: -4.1374e-04 - dice_multi: 0.9555
Epoch 77/100
400/400 - 533s - loss: 0.0160 - dice_multi: 0.9326
Epoch 78/100
400/400 - 533s - loss: 0.0044 - dice_multi: 0.9538
Epoch 79/100
400/400 - 533s - loss: 0.0017 - dice_multi: 0.9550
Epoch 80/100
400/400 - 533s - loss: 0.0014 - dice_multi: 0.9572
Epoch 81/100
400/400 - 533s - loss: 0.0012 - dice_multi: 0.9545
Epoch 82/100
400/400 - 533s - loss: 1.0645e-04 - dice_multi: 0.9562
Epoch 83/100
400/400 - 533s - loss: 0.0030 - dice_multi: 0.9496
Epoch 84/100
400/400 - 533s - loss: 0.0022 - dice_multi: 0.9545
Epoch 85/100
400/400 - 533s - loss: -5.3522e-05 - dice_multi: 0.9563
Epoch 86/100
400/400 - 533s - loss: 4.3112e-04 - dice_multi: 0.9571
Epoch 87/100
400/400 - 533s - loss: -3.1128e-04 - dice_multi: 0.9558
Epoch 88/100
400/400 - 533s - loss: -5.7219e-04 - dice_multi: 0.9567
Epoch 89/100
400/400 - 533s - loss: 0.0109 - dice_multi: 0.9401
Epoch 90/100
400/400 - 533s - loss: 0.0067 - dice_multi: 0.9473
Epoch 91/100
400/400 - 533s - loss: 0.0021 - dice_multi: 0.9545
Epoch 92/100
400/400 - 533s - loss: 0.0026 - dice_multi: 0.9533
Epoch 93/100
400/400 - 533s - loss: 1.3495e-04 - dice_multi: 0.9560
Epoch 94/100
400/400 - 533s - loss: -1.9416e-04 - dice_multi: 0.9577
Epoch 95/100
400/400 - 533s - loss: 0.0073 - dice_multi: 0.9433
Epoch 96/100
400/400 - 533s - loss: 0.0013 - dice_multi: 0.9559
Epoch 97/100
400/400 - 533s - loss: 3.9592e-04 - dice_multi: 0.9560
Epoch 98/100
400/400 - 533s - loss: -1.5038e-03 - dice_multi: 0.9558
Epoch 99/100
400/400 - 533s - loss: 6.8777e-04 - dice_multi: 0.9541
Epoch 100/100
400/400 - 533s - loss: 0.0108 - dice_multi: 0.9398
training time: 53322.316724300385
executation time:145.24568382898966
[0.9988198 0.934674 ]
